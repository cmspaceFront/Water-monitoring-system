System.register(["jimu-core","jimu-core/react"],(function(e,t){var o={},r={};return{setters:[function(e){o.DataSourceComponent=e.DataSourceComponent,o.UrlManager=e.UrlManager,o.jsx=e.jsx},function(e){r.useEffect=e.useEffect,r.useState=e.useState}],execute:function(){e((()=>{var e={97759:(e,t,o)=>{"use strict";o.d(t,{A:()=>l});var r=o(31601),n=o.n(r),i=o(76314),a=o.n(i)()(n());a.push([e.id,'.dam-gallery{font-family:system-ui,-apple-system,"Segoe UI",sans-serif}.dam-grid{padding:10px}.dam-card{will-change:transform,box-shadow;backface-visibility:hidden;perspective:1000px}.dam-card:focus{outline:2px solid #3b82f6;outline-offset:2px}.dam-card:focus:not(:focus-visible){outline:none}.dam-card img{will-change:transform;backface-visibility:hidden}.dam-card{animation:fadeInUp .6s cubic-bezier(0.4, 0, 0.2, 1) forwards;opacity:0;transform:translateY(20px)}@keyframes fadeInUp{to{opacity:1;transform:translateY(0)}}.dam-card:nth-child(1){animation-delay:.1s}.dam-card:nth-child(2){animation-delay:.2s}.dam-card:nth-child(3){animation-delay:.3s}.dam-card:nth-child(4){animation-delay:.4s}.dam-card:nth-child(5){animation-delay:.5s}.dam-card:nth-child(6){animation-delay:.6s}.dam-card:nth-child(n+7){animation-delay:.7s}@media(max-width: 768px){.dam-grid{grid-template-columns:repeat(auto-fill, minmax(200px, 1fr)) !important;gap:15px !important;padding:5px !important}.dam-card{min-height:240px !important}}@media(max-width: 480px){.dam-grid{grid-template-columns:1fr !important;gap:10px !important}}@media(prefers-reduced-motion: reduce){.dam-card,.dam-card img{animation:none !important;transition:none !important}}@media(prefers-contrast: high){.dam-card{border-width:2px !important;border-color:currentColor !important}}',""]);const l=a},76314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var o="",r=void 0!==t[5];return t[4]&&(o+="@supports (".concat(t[4],") {")),t[2]&&(o+="@media ".concat(t[2]," {")),r&&(o+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),o+=e(t),r&&(o+="}"),t[2]&&(o+="}"),t[4]&&(o+="}"),o})).join("")},t.i=function(e,o,r,n,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var l=0;l<this.length;l++){var s=this[l][0];null!=s&&(a[s]=!0)}for(var u=0;u<e.length;u++){var d=[].concat(e[u]);r&&a[d[0]]||(void 0!==i&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=i),o&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=o):d[2]=o),n&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=n):d[4]="".concat(n)),t.push(d))}},t}},31601:e=>{"use strict";e.exports=function(e){return e[1]}},85072:e=>{"use strict";var t=[];function o(e){for(var o=-1,r=0;r<t.length;r++)if(t[r].identifier===e){o=r;break}return o}function r(e,r){for(var i={},a=[],l=0;l<e.length;l++){var s=e[l],u=r.base?s[0]+r.base:s[0],d=i[u]||0,c="".concat(u," ").concat(d);i[u]=d+1;var f=o(c),v={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==f)t[f].references++,t[f].updater(v);else{var p=n(v,r);r.byIndex=l,t.splice(l,0,{identifier:c,updater:p,references:1})}a.push(c)}return a}function n(e,t){var o=t.domAPI(t);o.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;o.update(e=t)}else o.remove()}}e.exports=function(e,n){var i=r(e=e||[],n=n||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var l=o(i[a]);t[l].references--}for(var s=r(e,n),u=0;u<i.length;u++){var d=o(i[u]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}i=s}}},77659:e=>{"use strict";var t={};e.exports=function(e,o){var r=function(e){if(void 0===t[e]){var o=document.querySelector(e);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(e){o=null}t[e]=o}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(o)}},10540:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},55056:(e,t,o)=>{"use strict";e.exports=function(e){var t=o.nc;t&&e.setAttribute("nonce",t)}},97825:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(o){!function(e,t,o){var r="";o.supports&&(r+="@supports (".concat(o.supports,") {")),o.media&&(r+="@media ".concat(o.media," {"));var n=void 0!==o.layer;n&&(r+="@layer".concat(o.layer.length>0?" ".concat(o.layer):""," {")),r+=o.css,n&&(r+="}"),o.media&&(r+="}"),o.supports&&(r+="}");var i=o.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,o)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},41113:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},27193:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=27193,e.exports=t},79244:e=>{"use strict";e.exports=o},68972:e=>{"use strict";e.exports=r}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={id:o,exports:{}};return e[o](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="",n.nc=void 0;var i={};return n.p=window.jimuConfig.baseUrl,(()=>{"use strict";n.r(i),n.d(i,{__set_webpack_public_path__:()=>M,default:()=>W});var e=n(79244),t=n(68972),o=n(85072),r=n.n(o),a=n(97825),l=n.n(a),s=n(77659),u=n.n(s),d=n(55056),c=n.n(d),f=n(10540),v=n.n(f),p=n(41113),g=n.n(p),m=n(97759),y={};y.styleTagTransform=g(),y.setAttributes=c(),y.insert=u().bind(null,"head"),y.domAPI=l(),y.insertStyleElement=v();r()(m.A,y);m.A&&m.A.locals&&m.A.locals;const h=n.p+"06564d0c4065167b838b.png";var x=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))};function b(e,t,o){var r,n,i,a,l,s,u,d,c,f,v,p,g,m;const y=null!==(r=null==e?void 0:e.default)&&void 0!==r?r:{},h=null!==(n=null==e?void 0:e.hover)&&void 0!==n?n:{},x=t?Object.assign(Object.assign({},y),h):y;return{borderRadius:(null!==(i=x.borderRadius)&&void 0!==i?i:12)+"px",borderWidth:(null!==(a=x.borderWidth)&&void 0!==a?a:1)+"px",borderColor:null!==(l=T(x.borderColor,o))&&void 0!==l?l:"#e2e8f0",background:null!==(s=T(x.backgroundColor,o))&&void 0!==s?s:"#ffffff",color:null!==(u=T(x.textColor,o))&&void 0!==u?u:"#1e293b",padding:(null!==(d=x.padding)&&void 0!==d?d:12)+"px",boxShadow:null!==(c=x.boxShadow)&&void 0!==c?c:"0 2px 8px rgba(0,0,0,0.1)",minHeight:(null!==(f=x.cardHeight)&&void 0!==f?f:280)+"px",minWidth:(null!==(v=x.cardWidth)&&void 0!==v?v:240)+"px",borderStyle:"solid",fontSize:(null!==(p=x.fontSize)&&void 0!==p?p:14)+"px",fontWeight:null!==(g=x.fontWeight)&&void 0!==g?g:500,outline:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"stretch",overflow:"hidden",position:"relative",transform:t?null!==(m=h.transform)&&void 0!==m?m:"translateY(-2px)":"translateY(0)"}}function w(e,t){var o,r,n,i,a;const l=null!==(r=null===(o=null==e?void 0:e.default)||void 0===o?void 0:o.gap)&&void 0!==r?r:20;return{display:"grid",gridTemplateColumns:`repeat(auto-fill, minmax(${null!==(i=null===(n=null==e?void 0:e.default)||void 0===n?void 0:n.cardWidth)&&void 0!==i?i:240}px, 1fr))`,gap:l+"px",alignItems:"stretch",justifyItems:"center",width:"100%",boxSizing:"border-box",padding:"10px",background:null!==(a=T(null==e?void 0:e.parentBackgroundColor,t))&&void 0!==a?a:"#fafbfc",transition:"background 0.1s"}}const S="selected-year",k="selected_dam",z="selected-region";function C(e){return localStorage.getItem(e)}function _(){try{const e=localStorage.getItem("exb_auth");if(e)try{const t=JSON.parse(e);if(t.email)return t.email;if(t.user&&t.user.email)return t.user.email;if(t.username&&t.username.includes("@"))return t.username}catch(e){}const t=Object.keys(localStorage).filter((e=>e.includes("portalApp")||e.includes("portal")||e.includes("token")||e.includes("credential")));for(const e of t)try{const t=localStorage.getItem(e),o=JSON.parse(t||"{}");if(o.email)return o.email}catch(e){continue}const o=Object.keys(localStorage);for(const e of o)try{const t=localStorage.getItem(e);if(t&&(t.includes('"email"')||t.includes("farhodmf")||t.includes("@"))){const e=JSON.parse(t);if(e.email)return e.email}}catch(t){const o=localStorage.getItem(e);if(o&&o.includes("@")&&o.length<100)return o;continue}return null}catch(e){return console.error("\u{1f510} Gallery: Error extracting user email:",e),null}}const j={"\u049a\u043e\u0440\u0430\u049b\u0430\u043b\u043f\u043e\u0493\u0438\u0441\u0442\u043e\u043d \u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430\u0441\u0438":{ru:"\u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430 \u041a\u0430\u0440\u0430\u043a\u0430\u043b\u043f\u0430\u043a\u0441\u0442\u0430\u043d",uz:"Qoraqalpogiston Respublikasi",uzcryl:"\u049a\u043e\u0440\u0430\u049b\u0430\u043b\u043f\u043e\u0493\u0438\u0441\u0442\u043e\u043d \u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430\u0441\u0438"},"\u0410\u043d\u0434\u0438\u0436\u043e\u043d \u0432\u0438\u043b\u043e\u044f\u0442\u0438":{ru:"\u0410\u043d\u0434\u0438\u0436\u0430\u043d\u0441\u043a\u0430\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u044c",uz:"Andijon viloyati",uzcryl:"\u0410\u043d\u0434\u0438\u0436\u043e\u043d \u0432\u0438\u043b\u043e\u044f\u0442\u0438"},"\u0411\u0443\u0445\u043e\u0440\u043e \u0432\u0438\u043b\u043e\u044f\u0442\u0438":{ru:"\u0411\u0443\u0445\u0430\u0440\u0441\u043a\u0430\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u044c",uz:"Buxoro viloyati",uzcryl:"\u0411\u0443\u0445\u043e\u0440\u043e \u0432\u0438\u043b\u043e\u044f\u0442\u0438"},"\u0424\u0430\u0440\u0493\u043e\u043d\u0430 \u0432\u0438\u043b\u043e\u044f\u0442\u0438":{ru:"\u0424\u0435\u0440\u0433\u0430\u043d\u0441\u043a\u0430\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u044c",uz:"Fargona viloyati",uzcryl:"\u0424\u0430\u0440\u0493\u043e\u043d\u0430 \u0432\u0438\u043b\u043e\u044f\u0442\u0438"},"\u0416\u0438\u0437\u0437\u0430\u0445 \u0432\u0438\u043b\u043e\u044f\u0442\u0438":{ru:"\u0414\u0436\u0438\u0437\u0430\u043a\u0441\u043a\u0430\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u044c",uz:"Jizzax viloyati",uzcryl:"\u0416\u0438\u0437\u0437\u0430\u0445 \u0432\u0438\u043b\u043e\u044f\u0442\u0438"},"\u0425\u043e\u0440\u0430\u0437\u043c \u0432\u0438\u043b\u043e\u044f\u0442\u0438":{ru:"\u0425\u043e\u0440\u0435\u0437\u043c\u0441\u043a\u0430\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u044c",uz:"Xorazm viloyati",uzcryl:"\u0425\u043e\u0440\u0430\u0437\u043c \u0432\u0438\u043b\u043e\u044f\u0442\u0438"},"\u041d\u0430\u043c\u0430\u043d\u0433\u0430\u043d \u0432\u0438\u043b\u043e\u044f\u0442\u0438":{ru:"\u041d\u0430\u043c\u0430\u043d\u0433\u0430\u043d\u0441\u043a\u0430\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u044c",uz:"Namangan viloyati",uzcryl:"\u041d\u0430\u043c\u0430\u043d\u0433\u0430\u043d \u0432\u0438\u043b\u043e\u044f\u0442\u0438"},"\u041d\u0430\u0432\u043e\u0438\u0439 \u0432\u0438\u043b\u043e\u044f\u0442\u0438":{ru:"\u041d\u0430\u0432\u043e\u0438\u0439\u0441\u043a\u0430\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u044c",uz:"Navoiy viloyati",uzcryl:"\u041d\u0430\u0432\u043e\u0438\u0439 \u0432\u0438\u043b\u043e\u044f\u0442\u0438"},"\u049a\u0430\u0448\u049b\u0430\u0434\u0430\u0440\u0451 \u0432\u0438\u043b\u043e\u044f\u0442\u0438":{ru:"\u041a\u0430\u0448\u043a\u0430\u0434\u0430\u0440\u044c\u0438\u043d\u0441\u043a\u0430\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u044c",uz:"Qashqadaryo viloyati",uzcryl:"\u049a\u0430\u0448\u049b\u0430\u0434\u0430\u0440\u0451 \u0432\u0438\u043b\u043e\u044f\u0442\u0438"},"\u0421\u0430\u043c\u0430\u0440\u049b\u0430\u043d\u0434 \u0432\u0438\u043b\u043e\u044f\u0442\u0438":{ru:"\u0421\u0430\u043c\u0430\u0440\u043a\u0430\u043d\u0434\u0441\u043a\u0430\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u044c",uz:"Samarqand viloyati",uzcryl:"\u0421\u0430\u043c\u0430\u0440\u049b\u0430\u043d\u0434 \u0432\u0438\u043b\u043e\u044f\u0442\u0438"},"\u0421\u0438\u0440\u0434\u0430\u0440\u0451 \u0432\u0438\u043b\u043e\u044f\u0442\u0438":{ru:"\u0421\u044b\u0440\u0434\u0430\u0440\u044c\u0438\u043d\u0441\u043a\u0430\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u044c",uz:"Sirdaryo viloyati",uzcryl:"\u0421\u0438\u0440\u0434\u0430\u0440\u0451 \u0432\u0438\u043b\u043e\u044f\u0442\u0438"},"\u0421\u0443\u0440\u0445\u043e\u043d\u0434\u0430\u0440\u0451 \u0432\u0438\u043b\u043e\u044f\u0442\u0438":{ru:"\u0421\u0443\u0440\u0445\u0430\u043d\u0434\u0430\u0440\u044c\u0438\u043d\u0441\u043a\u0430\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u044c",uz:"Surxondaryo viloyati",uzcryl:"\u0421\u0443\u0440\u0445\u043e\u043d\u0434\u0430\u0440\u0451 \u0432\u0438\u043b\u043e\u044f\u0442\u0438"},"\u0422\u043e\u0448\u043a\u0435\u043d\u0442 \u0432\u0438\u043b\u043e\u044f\u0442\u0438":{ru:"\u0422\u0430\u0448\u043a\u0435\u043d\u0442\u0441\u043a\u0430\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u044c",uz:"Toshkent viloyati",uzcryl:"\u0422\u043e\u0448\u043a\u0435\u043d\u0442 \u0432\u0438\u043b\u043e\u044f\u0442\u0438"},"\u0422\u043e\u0448\u043a\u0435\u043d\u0442 \u0448\u0430\u04b3\u0440\u0438":{ru:"\u0413\u043e\u0440\u043e\u0434 \u0422\u0430\u0448\u043a\u0435\u043d\u0442",uz:"Toshkent shahri",uzcryl:"\u0422\u043e\u0448\u043a\u0435\u043d\u0442 \u0448\u0430\u04b3\u0440\u0438"}};function I(){const e=localStorage.getItem("custom_locale");return"ru"===e||"uz"===e||"uzcryl"===e?e:"ru"}function E(){return"dark"===localStorage.getItem("customTheme")?"dark":"light"}function T(e,t){var o,r;return e&&"object"==typeof e&&(e.light||e.dark)?null!==(r=null!==(o=e[t])&&void 0!==o?o:e.light)&&void 0!==r?r:e.dark:e}function A(e,t,o,r){var n,i;const a=(null===(n=null==e?void 0:e.default)||void 0===n?void 0:n[`${t}Typography`])||{},l=o&&(null===(i=null==e?void 0:e.hover)||void 0===i?void 0:i[`${t}Typography`])||{};return Object.assign(Object.assign({},a),l)}const W=o=>{var r,i,a,l,s,u,d,c,f,v,p,g,m,y,W,M;const[O,G]=(0,t.useState)(),[U,D]=(0,t.useState)([]),[L,N]=(0,t.useState)([]),[P,R]=(0,t.useState)("All"),[H,B]=(0,t.useState)(null),[$,F]=(0,t.useState)(null),[q,Y]=(0,t.useState)(null),[J,V]=(0,t.useState)(null),[Q,K]=(0,t.useState)(!0),[X,Z]=(0,t.useState)(I()),[ee,te]=(0,t.useState)(E());(0,t.useEffect)((()=>{!function(){x(this,void 0,void 0,(function*(){K(!0);try{const e=yield function(){return x(this,arguments,void 0,(function*(e=3,t=1e3){let o=_();if(o)return o;for(let r=1;r<=e;r++)if(yield new Promise((e=>setTimeout(e,t))),o=_(),o)return o;return null}))}(3,1e3);V(e)}catch(e){console.error("\u{1f510} Gallery: Authentication error:",e),V(null)}finally{K(!1)}}))}()}),[]),(0,t.useEffect)((()=>{if(J||Q)return;const e=setInterval((()=>{const t=_();t&&(V(t),clearInterval(e))}),2e3),t=setTimeout((()=>{clearInterval(e)}),3e4);return()=>{clearInterval(e),clearTimeout(t)}}),[J,Q]),(0,t.useEffect)((()=>{localStorage.removeItem(k),B(C(S)),R(C(z)||"All"),F(null)}),[]),(0,t.useEffect)((()=>{let e=I();const t=e=>{if("custom_locale"===e.key){const e=I();Z(e)}};window.addEventListener("storage",t);const o=setInterval((()=>{const t=I();t!==e&&(e=t,Z(t))}),300);return()=>{window.removeEventListener("storage",t),clearInterval(o)}}),[]),(0,t.useEffect)((()=>{let e=E();const t=e=>{if("customTheme"===e.key){const e=E();te(e)}};window.addEventListener("storage",t);const o=setInterval((()=>{const t=E();t!==e&&(e=t,te(t))}),300);return()=>{window.removeEventListener("storage",t),clearInterval(o)}}),[]);const oe=null===(r=o.useDataSources)||void 0===r?void 0:r[0],re=(null===(i=o.config)||void 0===i?void 0:i.cardStyle)||{default:{borderRadius:12,borderWidth:1,borderColor:"#e2e8f0",backgroundColor:"#ffffff",textColor:"#1e293b",fontSize:14,fontWeight:500,cardHeight:280,cardWidth:240,padding:12,gap:20,imageHeight:180,imageRadius:8,imageGap:12,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},hover:{borderColor:"#3b82f6",backgroundColor:"#f8fafc",textColor:"#3b82f6",fontWeight:600,boxShadow:"0 8px 25px rgba(59,130,246,0.15)",transform:"translateY(-2px)"},parentBackgroundColor:{light:"#fafbfc",dark:"#18181b"}},ne=t=>{var r;const n=null===(r=o.config)||void 0===r?void 0:r.linkConfig;if(null==n?void 0:n.value){if("webAddress"===n.linkType||"WEB_ADDRESS"===n.linkType)window.open(n.value,n.openInNewTab?"_blank":"_self");else if("page"===n.linkType||"PAGE"===n.linkType)try{e.UrlManager.getInstance().changePage(n.value)}catch(e){console.error("\u{1f504} Gallery: UrlManager failed, trying window.location:",e);try{window.location.href=n.value}catch(e){console.error("\u{1f504} Gallery: window.location also failed:",e),window.history&&window.history.pushState&&window.history.pushState({},"",n.value)}}}else try{ne(t)}catch(e){console.error("\u{1f504} Gallery: Error navigating to details:",e)}};(0,t.useEffect)((()=>{let t,r,n;function i(e){switch(e.key){case S:B(e.newValue);break;case z:R(e.newValue||"All");break;case k:e.newValue&&ne(e.newValue),F(e.newValue)}}return window.addEventListener("storage",i),t=setInterval((()=>{const e=C(S);e!==H&&B(e)}),100),r=setInterval((()=>{const e=C(z)||"All";e!==P&&R(e)}),100),n=setInterval((()=>{var t;const r=C(k);if(r!==$){if(r){const n=null===(t=o.config)||void 0===t?void 0:t.linkConfig;if(null==n?void 0:n.value){if("webAddress"===n.linkType||"WEB_ADDRESS"===n.linkType)window.open(n.value,n.openInNewTab?"_blank":"_self");else if("page"===n.linkType||"PAGE"===n.linkType)try{e.UrlManager.getInstance().changePage(n.value)}catch(e){console.error("\u{1f504} Gallery: UrlManager failed, trying window.location:",e);try{window.location.href=n.value}catch(e){console.error("\u{1f504} Gallery: window.location also failed:",e),window.history&&window.history.pushState&&window.history.pushState({},"",n.value)}}}else ne(r)}F(r)}}),100),()=>{window.removeEventListener("storage",i),clearInterval(t),clearInterval(r),clearInterval(n)}}),[H,P,$]),(0,t.useEffect)((()=>{O&&J&&!Q&&ie()}),[O,J,Q]),(0,t.useEffect)((()=>{if(!J)return void N([]);let e=U;H&&"All"!==H&&(e=e.filter((e=>{var t;const o=((null===(t=null==e?void 0:e.feature)||void 0===t?void 0:t.attributes)||{}).made_year;return o&&o.toString()===H}))),P&&"All"!==P&&(e=e.filter((e=>{var t;return((null===(t=null==e?void 0:e.feature)||void 0===t?void 0:t.attributes)||{}).location===P}))),N(e)}),[U,H,P,J]);const ie=()=>x(void 0,void 0,void 0,(function*(){if(O&&o.id&&J)try{const e={where:"1=1",outFields:["name","location","made_year","allowed_users","title_ru","title_uz_c","title_uz_l"],returnGeometry:!0},t=(yield O.load(e,{widgetId:o.id})).filter((e=>{var t;const o=((null===(t=null==e?void 0:e.feature)||void 0===t?void 0:t.attributes)||{}).allowed_users;if(!o)return!1;return o.split(",").map((e=>e.trim().toLowerCase())).includes(J.toLowerCase())})),r=t.map((e=>{var t;let r=function(e,t){var o;if(!e)return null;const r=[e.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,""),e.toLowerCase().replace(/[^a-z0-9]/g,""),e.toLowerCase().replace(/[^a-z0-9]/g,""),e.toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\s+/g,"_")];if(null===(o=null==t?void 0:t.context)||void 0===o?void 0:o.folderUrl)for(const o of r){const r=`${t.context.folderUrl}dist/runtime/assets/dams/${o}.webp`;return console.log(`\u{1f5bc}\ufe0f Gallery: Trying image for ${e} (${o}): ${r}`),r}for(const t of r)try{const o=`./assets/dams/${t}.webp`,r=n(27193)(o);return console.log(`\u{1f5bc}\ufe0f Gallery: Loaded image for ${e} (${t}) via require`),r}catch(e){continue}return console.log(`\u{1f5bc}\ufe0f Gallery: Failed to load image for ${e}, will use placeholder`),null}(((null===(t=null==e?void 0:e.feature)||void 0===t?void 0:t.attributes)||{}).name||"",o);return r||(r=h),Object.assign(Object.assign({},e),{imageUrl:r})}));D(r)}catch(e){}}));(0,t.useEffect)((()=>{var e,t;const r=null===(e=o.stateProps)||void 0===e?void 0:e.queryString;if(r){const e=r.match(/region\s*=\s*'(.+?)'/i),o=null!==(t=null==e?void 0:e[1])&&void 0!==t?t:"All";R(o)}}),[null===(a=o.stateProps)||void 0===a?void 0:a.queryString]);const ae=t=>{var r;try{localStorage.setItem(k,t)}catch(e){console.error("\u{1f504} Gallery: Error setting selected_dam:",e)}const n=null===(r=o.config)||void 0===r?void 0:r.linkConfig;if(null==n?void 0:n.value){if("webAddress"===n.linkType||"WEB_ADDRESS"===n.linkType)window.open(n.value,n.openInNewTab?"_blank":"_self");else if("page"===n.linkType||"PAGE"===n.linkType)try{e.UrlManager.getInstance().changePage(n.value)}catch(e){console.error("\u{1f504} Gallery: UrlManager failed, trying window.location:",e);try{window.location.href=n.value}catch(e){console.error("\u{1f504} Gallery: window.location also failed:",e),window.history&&window.history.pushState&&window.history.pushState({},"",n.value)}}}else try{ne(t)}catch(e){console.error("\u{1f504} Gallery: Error navigating to details:",e)}};return Q?(0,e.jsx)("div",{className:"widget-custom jimu-widget dam-gallery",style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",padding:"40px 20px",fontFamily:"system-ui, -apple-system, sans-serif",background:null!==(l=T(re.parentBackgroundColor,ee))&&void 0!==l?l:"#f8fafc"}},(0,e.jsx)("div",{style:{background:null!==(u=T(null===(s=re.default)||void 0===s?void 0:s.backgroundColor,ee))&&void 0!==u?u:"#ffffff",padding:"32px",borderRadius:"16px",border:"1px solid #e2e8f0",boxShadow:"0 4px 16px rgba(0,0,0,0.1)"}},(0,e.jsx)("p",{style:{margin:"0 0 8px 0",fontWeight:600,fontSize:"18px",color:null!==(c=T(null===(d=re.default)||void 0===d?void 0:d.textColor,ee))&&void 0!==c?c:"#1e293b"}},"ru"===X?"\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438...":"uz"===X?"Avtorizatsiya tekshirilmoqda...":"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f \u0442\u0435\u043a\u0448\u0438\u0440\u0438\u043b\u043c\u043e\u049b\u0434\u0430..."),(0,e.jsx)("small",{style:{opacity:.7,fontSize:"14px",color:null!==(v=T(null===(f=re.default)||void 0===f?void 0:f.textColor,ee))&&void 0!==v?v:"#64748b"}},"ru"===X?"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435":"uz"===X?"Iltimos kuting":"\u0418\u043b\u0442\u0438\u043c\u043e\u0441 \u043a\u0443\u0442\u0438\u043d\u0433"))):J?(0,e.jsx)("div",{className:"widget-custom jimu-widget dam-gallery",style:{width:"100%",height:"100%",overflowY:"auto",fontFamily:"system-ui, -apple-system, sans-serif",background:null!==(M=T(re.parentBackgroundColor,ee))&&void 0!==M?M:"#fafbfc",transition:"background 0.1s"}},(0,e.jsx)(e.DataSourceComponent,{useDataSource:oe,widgetId:o.id,onDataSourceCreated:e=>{G(e)}}),(0,e.jsx)("div",{className:"dam-grid",style:w(re,ee)},L.map(((t,o)=>{var r,n,i,a,l,s,u,d,c,f,v,p,g,m,y,x,w,S,k;const z=(null===(r=null==t?void 0:t.feature)||void 0===r?void 0:r.attributes)||{};let C=z.name||"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043e";const _=z.name||"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043e";"ru"===X&&z.title_ru?C=z.title_ru:"uz"===X&&z.title_uz_l?C=z.title_uz_l:"uzcryl"===X&&z.title_uz_c&&(C=z.title_uz_c);const I=z.location||"",E=(null===(n=j[I])||void 0===n?void 0:n[X])||I,W=(z.made_year,t.imageUrl||h),M=q===o,O=null!==(a=null===(i=re.default)||void 0===i?void 0:i.imageHeight)&&void 0!==a?a:180,G=null!==(s=null===(l=re.default)||void 0===l?void 0:l.imageRadius)&&void 0!==s?s:8,U=null!==(d=null===(u=re.default)||void 0===u?void 0:u.imageGap)&&void 0!==d?d:12,D=A(re,"region",M),L=(A(re,"year",M),A(re,"dam",M));return(0,e.jsx)("div",{className:"dam-card",key:o,style:b(re,M,ee),tabIndex:0,onMouseEnter:()=>Y(o),onMouseLeave:()=>Y(null),onClick:()=>ae(_),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),ae(C))}},(0,e.jsx)("div",{style:{width:"100%",height:O+"px",overflow:"hidden",borderRadius:G+"px",marginBottom:U+"px",position:"relative",background:"#f1f5f9"}},(0,e.jsx)("img",{src:W,alt:C,style:{width:"100%",height:"100%",objectFit:"cover",transition:"transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)",transform:M?"scale(1.15)":"scale(1)"},onError:e=>{e.target.src=h}}),(0,e.jsx)("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"50%",background:"linear-gradient(transparent, rgba(0,0,0,0.1))",pointerEvents:"none"}})),(0,e.jsx)("div",{style:{width:"100%",textAlign:"left",flex:"1",display:"flex",flexDirection:"column",justifyContent:"flex-start"}},(0,e.jsx)("div",{style:{display:"flex",alignItems:"center",marginBottom:"4px"}},(0,e.jsx)("span",{style:{fontSize:(null!==(c=D.fontSize)&&void 0!==c?c:12)+"px",color:T(D.textColor,ee)||(M?T(null===(f=re.hover)||void 0===f?void 0:f.textColor,ee)||"#3b82f6":"#64748b"),fontWeight:null!==(v=D.fontWeight)&&void 0!==v?v:500,lineHeight:D.lineHeight?D.lineHeight.toString():"1.2",letterSpacing:void 0!==D.letterSpacing?D.letterSpacing+"px":"0.025em",textTransform:"uppercase",transition:"color 0.3s ease"}},E)),(0,e.jsx)("div",{style:{fontSize:(null!==(p=L.fontSize)&&void 0!==p?p:14)+"px",fontWeight:null!==(g=L.fontWeight)&&void 0!==g?g:M?null!==(y=null===(m=re.hover)||void 0===m?void 0:m.fontWeight)&&void 0!==y?y:600:null!==(w=null===(x=re.default)||void 0===x?void 0:x.fontWeight)&&void 0!==w?w:500,color:T(L.textColor,ee)||(M?T(null===(S=re.hover)||void 0===S?void 0:S.textColor,ee)||"#3b82f6":T(null===(k=re.default)||void 0===k?void 0:k.textColor,ee)||"#1e293b"),lineHeight:L.lineHeight?L.lineHeight.toString():"1.4",letterSpacing:void 0!==L.letterSpacing?L.letterSpacing+"px":"normal",transition:"all 0.3s ease",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"}},C)))})))):(0,e.jsx)("div",{className:"widget-custom jimu-widget dam-gallery",style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",padding:"40px 20px",fontFamily:"system-ui, -apple-system, sans-serif"}},(0,e.jsx)("div",{style:{background:null!==(p=T(re.parentBackgroundColor,ee))&&void 0!==p?p:"#f8fafc",padding:"32px",borderRadius:"16px",border:"1px solid #e2e8f0",boxShadow:"0 4px 16px rgba(0,0,0,0.1)"}},(0,e.jsx)("p",{style:{margin:"0 0 8px 0",fontWeight:600,fontSize:"18px",color:null!==(m=T(null===(g=re.default)||void 0===g?void 0:g.textColor,ee))&&void 0!==m?m:"#1e293b"}},"ru"===X?"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d":"uz"===X?"Foydalanuvchi avtorizatsiya qilinmagan":"\u0424\u043e\u0439\u0434\u0430\u043b\u0430\u043d\u0443\u0432\u0447\u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f \u049b\u0438\u043b\u0438\u043d\u043c\u0430\u0433\u0430\u043d"),(0,e.jsx)("small",{style:{opacity:.7,fontSize:"14px",color:null!==(W=T(null===(y=re.default)||void 0===y?void 0:y.textColor,ee))&&void 0!==W?W:"#64748b"}},"ru"===X?"\u0412\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u0434\u043b\u044f \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u043f\u043b\u043e\u0442\u0438\u043d":"uz"===X?"To'g'onlarni ko'rish uchun tizimga kiring":"\u0422\u045e\u0493\u043e\u043d\u043b\u0430\u0440\u043d\u0438 \u043a\u045e\u0440\u0438\u0448 \u0443\u0447\u0443\u043d \u0442\u0438\u0437\u0438\u043c\u0433\u0430 \u043a\u0438\u0440\u0438\u043d\u0433")))};function M(e){n.p=e}})(),i})())}}}));