System.register(["jimu-core","jimu-core/react"],(function(e,t){var o={},r={};return{setters:[function(e){o.DataSourceComponent=e.DataSourceComponent,o.jimuHistory=e.jimuHistory,o.jsx=e.jsx},function(e){r.useEffect=e.useEffect,r.useState=e.useState}],execute:function(){e((()=>{var e={1057:(e,t,o)=>{"use strict";o.d(t,{Z:()=>l});var r=o(8081),n=o.n(r),i=o(3645),a=o.n(i)()(n());a.push([e.id,'.dam-gallery{font-family:system-ui,-apple-system,"Segoe UI",sans-serif}.dam-grid{padding:10px}.dam-card{will-change:transform,box-shadow;backface-visibility:hidden;perspective:1000px}.dam-card:focus{outline:2px solid #3b82f6;outline-offset:2px}.dam-card:focus:not(:focus-visible){outline:none}.dam-card img{will-change:transform;backface-visibility:hidden}.dam-card{animation:fadeInUp .6s cubic-bezier(0.4, 0, 0.2, 1) forwards;opacity:0;transform:translateY(20px)}@keyframes fadeInUp{to{opacity:1;transform:translateY(0)}}.dam-card:nth-child(1){animation-delay:.1s}.dam-card:nth-child(2){animation-delay:.2s}.dam-card:nth-child(3){animation-delay:.3s}.dam-card:nth-child(4){animation-delay:.4s}.dam-card:nth-child(5){animation-delay:.5s}.dam-card:nth-child(6){animation-delay:.6s}.dam-card:nth-child(n+7){animation-delay:.7s}@media(max-width: 768px){.dam-grid{grid-template-columns:repeat(auto-fill, minmax(200px, 1fr)) !important;gap:15px !important;padding:5px !important}.dam-card{min-height:240px !important}}@media(max-width: 480px){.dam-grid{grid-template-columns:1fr !important;gap:10px !important}}@media(prefers-reduced-motion: reduce){.dam-card,.dam-card img{animation:none !important;transition:none !important}}@media(prefers-contrast: high){.dam-card{border-width:2px !important;border-color:currentColor !important}}',""]);const l=a},3645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var o="",r=void 0!==t[5];return t[4]&&(o+="@supports (".concat(t[4],") {")),t[2]&&(o+="@media ".concat(t[2]," {")),r&&(o+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),o+=e(t),r&&(o+="}"),t[2]&&(o+="}"),t[4]&&(o+="}"),o})).join("")},t.i=function(e,o,r,n,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var l=0;l<this.length;l++){var s=this[l][0];null!=s&&(a[s]=!0)}for(var u=0;u<e.length;u++){var d=[].concat(e[u]);r&&a[d[0]]||(void 0!==i&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=i),o&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=o):d[2]=o),n&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=n):d[4]="".concat(n)),t.push(d))}},t}},8081:e=>{"use strict";e.exports=function(e){return e[1]}},3379:e=>{"use strict";var t=[];function o(e){for(var o=-1,r=0;r<t.length;r++)if(t[r].identifier===e){o=r;break}return o}function r(e,r){for(var i={},a=[],l=0;l<e.length;l++){var s=e[l],u=r.base?s[0]+r.base:s[0],d=i[u]||0,c="".concat(u," ").concat(d);i[u]=d+1;var f=o(c),v={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==f)t[f].references++,t[f].updater(v);else{var m=n(v,r);r.byIndex=l,t.splice(l,0,{identifier:c,updater:m,references:1})}a.push(c)}return a}function n(e,t){var o=t.domAPI(t);return o.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;o.update(e=t)}else o.remove()}}e.exports=function(e,n){var i=r(e=e||[],n=n||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var l=o(i[a]);t[l].references--}for(var s=r(e,n),u=0;u<i.length;u++){var d=o(i[u]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}i=s}}},569:e=>{"use strict";var t={};e.exports=function(e,o){var r=function(e){if(void 0===t[e]){var o=document.querySelector(e);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(e){o=null}t[e]=o}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(o)}},9216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:(e,t,o)=>{"use strict";e.exports=function(e){var t=o.nc;t&&e.setAttribute("nonce",t)}},7795:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(o){!function(e,t,o){var r="";o.supports&&(r+="@supports (".concat(o.supports,") {")),o.media&&(r+="@media ".concat(o.media," {"));var n=void 0!==o.layer;n&&(r+="@layer".concat(o.layer.length>0?" ".concat(o.layer):""," {")),r+=o.css,n&&(r+="}"),o.media&&(r+="}"),o.supports&&(r+="}");var i=o.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,o)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},4589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},8891:e=>{"use strict";e.exports=o},1315:e=>{"use strict";e.exports=r}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={id:o,exports:{}};return e[o](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="",n.nc=void 0;var i={};return n.p=window.jimuConfig.baseUrl,(()=>{"use strict";n.r(i),n.d(i,{__set_webpack_public_path__:()=>N,default:()=>U});var e=n(8891),t=n(1315),o=n(3379),r=n.n(o),a=n(7795),l=n.n(a),s=n(569),u=n.n(s),d=n(3565),c=n.n(d),f=n(9216),v=n.n(f),m=n(4589),p=n.n(m),g=n(1057),h={};h.styleTagTransform=p(),h.setAttributes=c(),h.insert=u().bind(null,"head"),h.domAPI=l(),h.insertStyleElement=v(),r()(g.Z,h),g.Z&&g.Z.locals&&g.Z.locals;var y=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))};function x(e,t){return(null==e?void 0:e.folderUrl)?`${"dark"===(null==t?void 0:t.toLowerCase())?`${e.folderUrl}dist/runtime/assets/PlhDark.png`:`${e.folderUrl}dist/runtime/assets/PlhLight.png`}?v=${Date.now()}`:"data:image/svg+xml;base64,..."}function b(e,t){if(!e||!(null==t?void 0:t.folderUrl))return null;const o=e.toLowerCase().replace(/\s+/g,"_");return`${t.folderUrl}dist/runtime/assets/dams/${o}.webp`}function w(e,t,o){var r,n,i,a,l,s,u,d,c,f,v,m,p,g;const h=null!==(r=null==e?void 0:e.default)&&void 0!==r?r:{},y=null!==(n=null==e?void 0:e.hover)&&void 0!==n?n:{},x=t?Object.assign(Object.assign({},h),y):h;return{borderRadius:(null!==(i=x.borderRadius)&&void 0!==i?i:12)+"px",borderWidth:(null!==(a=x.borderWidth)&&void 0!==a?a:1)+"px",borderColor:null!==(l=A(x.borderColor,o))&&void 0!==l?l:"#e2e8f0",background:null!==(s=A(x.backgroundColor,o))&&void 0!==s?s:"#ffffff",color:null!==(u=A(x.textColor,o))&&void 0!==u?u:"#1e293b",padding:(null!==(d=x.padding)&&void 0!==d?d:12)+"px",boxShadow:null!==(c=x.boxShadow)&&void 0!==c?c:"0 2px 8px rgba(0,0,0,0.1)",minHeight:(null!==(f=x.cardHeight)&&void 0!==f?f:280)+"px",minWidth:(null!==(v=x.cardWidth)&&void 0!==v?v:240)+"px",borderStyle:"solid",fontSize:(null!==(m=x.fontSize)&&void 0!==m?m:14)+"px",fontWeight:null!==(p=x.fontWeight)&&void 0!==p?p:500,outline:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"stretch",overflow:"hidden",position:"relative",transform:t?null!==(g=y.transform)&&void 0!==g?g:"translateY(-2px)":"translateY(0)"}}function S(e,t){var o,r,n,i,a;const l=null!==(r=null===(o=null==e?void 0:e.default)||void 0===o?void 0:o.gap)&&void 0!==r?r:20;return{display:"grid",gridTemplateColumns:`repeat(auto-fill, minmax(${null!==(i=null===(n=null==e?void 0:e.default)||void 0===n?void 0:n.cardWidth)&&void 0!==i?i:240}px, 1fr))`,gap:l+"px",alignItems:"stretch",justifyItems:"center",width:"100%",boxSizing:"border-box",padding:"10px",background:null!==(a=A(null==e?void 0:e.parentBackgroundColor,t))&&void 0!==a?a:"#fafbfc",transition:"background 0.1s"}}const z="selected-year",k="selected_dam",j="selected-region";function C(e){return localStorage.getItem(e)}function I(){try{const e=localStorage.getItem("exb_auth");if(e)try{const t=JSON.parse(e);if(t.email)return t.email;if(t.user&&t.user.email)return t.user.email;if(t.username&&t.username.includes("@"))return t.username}catch(e){}const t=Object.keys(localStorage).filter((e=>e.includes("portalApp")||e.includes("portal")||e.includes("token")||e.includes("credential")));for(const e of t)try{const t=localStorage.getItem(e),o=JSON.parse(t||"{}");if(o.email)return o.email}catch(e){continue}const o=Object.keys(localStorage);for(const e of o)try{const t=localStorage.getItem(e);if(t&&(t.includes('"email"')||t.includes("farhodmf")||t.includes("@"))){const e=JSON.parse(t);if(e.email)return e.email}}catch(t){const o=localStorage.getItem(e);if(o&&o.includes("@")&&o.length<100)return o;continue}return null}catch(e){return console.error("üîê Gallery: Error extracting user email:",e),null}}const _={"“ö–æ—Ä–∞“õ–∞–ª–ø–æ“ì–∏—Å—Ç–æ–Ω –†–µ—Å–ø—É–±–ª–∏–∫–∞—Å–∏":{ru:"–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–∞—Ä–∞–∫–∞–ª–ø–∞–∫—Å—Ç–∞–Ω",uz:"Qoraqalpogiston Respublikasi",uzcryl:"“ö–æ—Ä–∞“õ–∞–ª–ø–æ“ì–∏—Å—Ç–æ–Ω –†–µ—Å–ø—É–±–ª–∏–∫–∞—Å–∏"},"–ê–Ω–¥–∏–∂–æ–Ω –≤–∏–ª–æ—è—Ç–∏":{ru:"–ê–Ω–¥–∏–∂–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",uz:"Andijon viloyati",uzcryl:"–ê–Ω–¥–∏–∂–æ–Ω –≤–∏–ª–æ—è—Ç–∏"},"–ë—É—Ö–æ—Ä–æ –≤–∏–ª–æ—è—Ç–∏":{ru:"–ë—É—Ö–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",uz:"Buxoro viloyati",uzcryl:"–ë—É—Ö–æ—Ä–æ –≤–∏–ª–æ—è—Ç–∏"},"–§–∞—Ä“ì–æ–Ω–∞ –≤–∏–ª–æ—è—Ç–∏":{ru:"–§–µ—Ä–≥–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",uz:"Fargona viloyati",uzcryl:"–§–∞—Ä“ì–æ–Ω–∞ –≤–∏–ª–æ—è—Ç–∏"},"–ñ–∏–∑–∑–∞—Ö –≤–∏–ª–æ—è—Ç–∏":{ru:"–î–∂–∏–∑–∞–∫—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",uz:"Jizzax viloyati",uzcryl:"–ñ–∏–∑–∑–∞—Ö –≤–∏–ª–æ—è—Ç–∏"},"–•–æ—Ä–∞–∑–º –≤–∏–ª–æ—è—Ç–∏":{ru:"–•–æ—Ä–µ–∑–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",uz:"Xorazm viloyati",uzcryl:"–•–æ—Ä–∞–∑–º –≤–∏–ª–æ—è—Ç–∏"},"–ù–∞–º–∞–Ω–≥–∞–Ω –≤–∏–ª–æ—è—Ç–∏":{ru:"–ù–∞–º–∞–Ω–≥–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",uz:"Namangan viloyati",uzcryl:"–ù–∞–º–∞–Ω–≥–∞–Ω –≤–∏–ª–æ—è—Ç–∏"},"–ù–∞–≤–æ–∏–π –≤–∏–ª–æ—è—Ç–∏":{ru:"–ù–∞–≤–æ–∏–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",uz:"Navoiy viloyati",uzcryl:"–ù–∞–≤–æ–∏–π –≤–∏–ª–æ—è—Ç–∏"},"“ö–∞—à“õ–∞–¥–∞—Ä—ë –≤–∏–ª–æ—è—Ç–∏":{ru:"–ö–∞—à–∫–∞–¥–∞—Ä—å–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",uz:"Qashqadaryo viloyati",uzcryl:"“ö–∞—à“õ–∞–¥–∞—Ä—ë –≤–∏–ª–æ—è—Ç–∏"},"–°–∞–º–∞—Ä“õ–∞–Ω–¥ –≤–∏–ª–æ—è—Ç–∏":{ru:"–°–∞–º–∞—Ä–∫–∞–Ω–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",uz:"Samarqand viloyati",uzcryl:"–°–∞–º–∞—Ä“õ–∞–Ω–¥ –≤–∏–ª–æ—è—Ç–∏"},"–°–∏—Ä–¥–∞—Ä—ë –≤–∏–ª–æ—è—Ç–∏":{ru:"–°—ã—Ä–¥–∞—Ä—å–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",uz:"Sirdaryo viloyati",uzcryl:"–°–∏—Ä–¥–∞—Ä—ë –≤–∏–ª–æ—è—Ç–∏"},"–°—É—Ä—Ö–æ–Ω–¥–∞—Ä—ë –≤–∏–ª–æ—è—Ç–∏":{ru:"–°—É—Ä—Ö–∞–Ω–¥–∞—Ä—å–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",uz:"Surxondaryo viloyati",uzcryl:"–°—É—Ä—Ö–æ–Ω–¥–∞—Ä—ë –≤–∏–ª–æ—è—Ç–∏"},"–¢–æ—à–∫–µ–Ω—Ç –≤–∏–ª–æ—è—Ç–∏":{ru:"–¢–∞—à–∫–µ–Ω—Ç—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",uz:"Toshkent viloyati",uzcryl:"–¢–æ—à–∫–µ–Ω—Ç –≤–∏–ª–æ—è—Ç–∏"},"–¢–æ—à–∫–µ–Ω—Ç —à–∞“≥—Ä–∏":{ru:"–ì–æ—Ä–æ–¥ –¢–∞—à–∫–µ–Ω—Ç",uz:"Toshkent shahri",uzcryl:"–¢–æ—à–∫–µ–Ω—Ç —à–∞“≥—Ä–∏"}};function E(){const e=localStorage.getItem("custom_locale");return"ru"===e||"uz"===e||"uzcryl"===e?e:"ru"}function T(){return"dark"===localStorage.getItem("customTheme")?"dark":"light"}function A(e,t){var o,r;return e&&"object"==typeof e&&(e.light||e.dark)?null!==(r=null!==(o=e[t])&&void 0!==o?o:e.light)&&void 0!==r?r:e.dark:e}function L(e,t,o,r){var n,i;const a=(null===(n=null==e?void 0:e.default)||void 0===n?void 0:n[`${t}Typography`])||{},l=o&&(null===(i=null==e?void 0:e.hover)||void 0===i?void 0:i[`${t}Typography`])||{};return Object.assign(Object.assign({},a),l)}const U=o=>{var r,n,i,a,l,s,u,d,c,f,v,m,p,g,h,U;const[N,R]=(0,t.useState)(),[P,W]=(0,t.useState)([]),[H,O]=(0,t.useState)([]),[$,D]=(0,t.useState)("All"),[M,B]=(0,t.useState)(null),[F,q]=(0,t.useState)(null),[G,Y]=(0,t.useState)(null),[J,V]=(0,t.useState)(null),[Z,Q]=(0,t.useState)(!0),[K,X]=(0,t.useState)(E()),[ee,te]=(0,t.useState)(T()),[oe,re]=(0,t.useState)(0);(0,t.useEffect)((()=>{!function(){y(this,void 0,void 0,(function*(){Q(!0);try{const e=yield function(){return y(this,arguments,void 0,(function*(e=3,t=1e3){let o=I();if(o)return o;for(let r=1;r<=e;r++)if(yield new Promise((e=>setTimeout(e,t))),o=I(),o)return o;return null}))}(3,1e3);V(e)}catch(e){console.error("üîê Gallery: Authentication error:",e),V(null)}finally{Q(!1)}}))}()}),[]),(0,t.useEffect)((()=>{if(J||Z)return;const e=setInterval((()=>{const t=I();t&&(V(t),clearInterval(e))}),2e3),t=setTimeout((()=>{clearInterval(e)}),3e4);return()=>{clearInterval(e),clearTimeout(t)}}),[J,Z]),(0,t.useEffect)((()=>{localStorage.removeItem(k),B(C(z)),D(C(j)||"All"),q(null)}),[]),(0,t.useEffect)((()=>{let e=E();const t=e=>{if("custom_locale"===e.key){const e=E();X(e)}};window.addEventListener("storage",t);const o=setInterval((()=>{const t=E();t!==e&&(e=t,X(t))}),300);return()=>{window.removeEventListener("storage",t),clearInterval(o)}}),[]),(0,t.useEffect)((()=>{let e=T();const t=e=>{if("customTheme"===e.key){const e=T();te(e),re((e=>e+1))}};window.addEventListener("storage",t);const o=setInterval((()=>{const t=T();t!==e&&(e=t,te(t),re((e=>e+1)))}),300);return()=>{window.removeEventListener("storage",t),clearInterval(o)}}),[]);const ne=null===(r=o.useDataSources)||void 0===r?void 0:r[0],ie=(null===(n=o.config)||void 0===n?void 0:n.cardStyle)||{default:{borderRadius:12,borderWidth:1,borderColor:"#e2e8f0",backgroundColor:"#ffffff",textColor:"#1e293b",fontSize:14,fontWeight:500,cardHeight:280,cardWidth:240,padding:12,gap:20,imageHeight:180,imageRadius:8,imageGap:12,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},hover:{borderColor:"#3b82f6",backgroundColor:"#f8fafc",textColor:"#3b82f6",fontWeight:600,boxShadow:"0 8px 25px rgba(59,130,246,0.15)",transform:"translateY(-2px)"},parentBackgroundColor:{light:"#fafbfc",dark:"#18181b"}},ae=t=>{var r,n;const i=(null===(n=null===(r=o.config)||void 0===r?void 0:r.linkConfig)||void 0===n?void 0:n.value)||"dam-details";try{localStorage.setItem(k,t)}catch(e){console.error("üîÑ Navigation: Error setting selected_dam:",e)}let a=!1;try{e.jimuHistory.changePage(i),a=!0}catch(e){console.error("üîÑ Navigation: jimuHistory failed, trying URL-based navigation:",e)}if(!a)try{const e=window.location.href,o=new URLSearchParams(window.location.search);o.set("page",i),o.set("dam",t);const r=`${e.split("?")[0]}?${o.toString()}`;window.location.href=r,a=!0}catch(e){console.error("üîÑ Navigation: All navigation methods failed:",e)}};(0,t.useEffect)((()=>{let e,t,o;function r(e){switch(e.key){case z:B(e.newValue);break;case j:D(e.newValue||"All");break;case k:e.newValue&&ae(e.newValue),q(e.newValue)}}return window.addEventListener("storage",r),e=setInterval((()=>{const e=C(z);e!==M&&B(e)}),100),t=setInterval((()=>{const e=C(j)||"All";e!==$&&D(e)}),100),o=setInterval((()=>{const e=C(k);e!==F&&(e&&ae(e),q(e))}),100),()=>{window.removeEventListener("storage",r),clearInterval(e),clearInterval(t),clearInterval(o)}}),[M,$,F]),(0,t.useEffect)((()=>{N&&J&&!Z&&le(ee)}),[N,J,Z,ee]),(0,t.useEffect)((()=>{if(!J)return void O([]);let e=P;M&&"All"!==M&&(e=e.filter((e=>{var t;const o=((null===(t=null==e?void 0:e.feature)||void 0===t?void 0:t.attributes)||{}).made_year;return o&&o.toString()===M}))),$&&"All"!==$&&(e=e.filter((e=>{var t;return((null===(t=null==e?void 0:e.feature)||void 0===t?void 0:t.attributes)||{}).location===$}))),O(e)}),[P,M,$,J]);const le=e=>y(void 0,void 0,void 0,(function*(){if(N&&o.id&&J)try{const t={where:"1=1",outFields:["name","location","made_year","allowed_users","title_ru","title_uz_c","title_uz_l"],returnGeometry:!0},r=(yield N.load(t,{widgetId:o.id})).filter((e=>{var t;const o=((null===(t=null==e?void 0:e.feature)||void 0===t?void 0:t.attributes)||{}).allowed_users;return!!o&&o.split(",").map((e=>e.trim().toLowerCase())).includes(J.toLowerCase())})),n=r.map((t=>{var r;const n=((null===(r=null==t?void 0:t.feature)||void 0===r?void 0:r.attributes)||{}).name||"",i=e||ee,a=x(o.context,i),l=b(n,o.context)||a;return Object.assign(Object.assign({},t),{imageUrl:l})}));W(n)}catch(e){}}));(0,t.useEffect)((()=>{var e,t;const r=null===(e=o.stateProps)||void 0===e?void 0:e.queryString;if(r){const e=r.match(/region\s*=\s*'(.+?)'/i),o=null!==(t=null==e?void 0:e[1])&&void 0!==t?t:"All";D(o)}}),[null===(i=o.stateProps)||void 0===i?void 0:i.queryString]),(0,t.useEffect)((()=>{const e=function(e){try{return new URLSearchParams(window.location.search).get("dam")}catch(e){return console.error("üîÑ URL Parameter: Error reading URL parameter:",e),null}}();if(e)try{localStorage.setItem(k,e),q(e)}catch(e){console.error("üîÑ URL Parameter: Error setting dam from URL:",e)}}),[]),(0,t.useEffect)((()=>{P.length>0&&N&&J&&!Z&&le(ee)}),[ee,P.length,N,J,Z]),(0,t.useEffect)((()=>{if(P.length>0){const e=P.map((e=>{var t;const r=b(((null===(t=null==e?void 0:e.feature)||void 0===t?void 0:t.attributes)||{}).name||"",o.context),n=x(o.context,ee),i=r||n;return Object.assign(Object.assign({},e),{imageUrl:i})}));W(e)}}),[oe]);const se=t=>{var r;try{localStorage.setItem(k,t)}catch(e){console.error("üîÑ Gallery: Error setting selected_dam:",e)}const n=null===(r=o.config)||void 0===r?void 0:r.linkConfig;if(null==n?void 0:n.value){if("webAddress"===n.linkType||"WEB_ADDRESS"===n.linkType)window.open(n.value,n.openInNewTab?"_blank":"_self");else if("page"===n.linkType||"PAGE"===n.linkType){let t=!1;try{e.jimuHistory.changePage(n.value),t=!0}catch(e){console.error("üîÑ Navigation: jimuHistory failed, trying URL-based navigation:",e)}if(!t)try{const e=window.location.href,o=new URLSearchParams(window.location.search);o.set("page",n.value);const r=`${e.split("?")[0]}?${o.toString()}`;window.location.href=r,t=!0}catch(e){console.error("üîÑ Navigation: All navigation methods failed:",e)}t||console.error("üîÑ Navigation: No navigation method succeeded")}}else try{ae(t)}catch(e){console.error("üîÑ Gallery: Error navigating to details:",e)}};return Z?(0,e.jsx)("div",{className:"widget-custom jimu-widget dam-gallery",style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",padding:"40px 20px",fontFamily:"system-ui, -apple-system, sans-serif",background:null!==(a=A(ie.parentBackgroundColor,ee))&&void 0!==a?a:"#f8fafc"}},(0,e.jsx)("div",{style:{background:null!==(s=A(null===(l=ie.default)||void 0===l?void 0:l.backgroundColor,ee))&&void 0!==s?s:"#ffffff",padding:"32px",borderRadius:"16px",border:"1px solid #e2e8f0",boxShadow:"0 4px 16px rgba(0,0,0,0.1)"}},(0,e.jsx)("p",{style:{margin:"0 0 8px 0",fontWeight:600,fontSize:"18px",color:null!==(d=A(null===(u=ie.default)||void 0===u?void 0:u.textColor,ee))&&void 0!==d?d:"#1e293b"}},"ru"===K?"–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏...":"uz"===K?"Avtorizatsiya tekshirilmoqda...":"–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ç–µ–∫—à–∏—Ä–∏–ª–º–æ“õ–¥–∞..."),(0,e.jsx)("small",{style:{opacity:.7,fontSize:"14px",color:null!==(f=A(null===(c=ie.default)||void 0===c?void 0:c.textColor,ee))&&void 0!==f?f:"#64748b"}},"ru"===K?"–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ":"uz"===K?"Iltimos kuting":"–ò–ª—Ç–∏–º–æ—Å –∫—É—Ç–∏–Ω–≥"))):J?(0,e.jsx)("div",{className:"widget-custom jimu-widget dam-gallery",style:{width:"100%",height:"100%",overflowY:"auto",fontFamily:"system-ui, -apple-system, sans-serif",background:null!==(U=A(ie.parentBackgroundColor,ee))&&void 0!==U?U:"#fafbfc",transition:"background 0.1s"}},(0,e.jsx)(e.DataSourceComponent,{useDataSource:ne,widgetId:o.id,onDataSourceCreated:e=>{R(e)}}),(0,e.jsx)("div",{className:"dam-grid",style:S(ie,ee)},(()=>{const t=new Map;return H.forEach((e=>{var o;const r=((null===(o=null==e?void 0:e.feature)||void 0===o?void 0:o.attributes)||{}).name||"–ù–∞–∑–≤–∞–Ω–∏–µ –Ω–µ —É–∫–∞–∑–∞–Ω–æ";t.has(r)||t.set(r,e)})),Array.from(t.values()).map(((t,r)=>{var n,i,a,l,s,u,d,c,f,v,m,p,g,h,y,b,S,z,k;const j=(null===(n=null==t?void 0:t.feature)||void 0===n?void 0:n.attributes)||{};let C=j.name||"–ù–∞–∑–≤–∞–Ω–∏–µ –Ω–µ —É–∫–∞–∑–∞–Ω–æ";const I=j.name||"–ù–∞–∑–≤–∞–Ω–∏–µ –Ω–µ —É–∫–∞–∑–∞–Ω–æ";"ru"===K&&j.title_ru?C=j.title_ru:"uz"===K&&j.title_uz_l?C=j.title_uz_l:"uzcryl"===K&&j.title_uz_c&&(C=j.title_uz_c);const E=j.location||"",T=(null===(i=_[E])||void 0===i?void 0:i[K])||E,U=(j.made_year,t.imageUrl||x(o.context,ee)),N=G===r,R=null!==(l=null===(a=ie.default)||void 0===a?void 0:a.imageHeight)&&void 0!==l?l:180,P=null!==(u=null===(s=ie.default)||void 0===s?void 0:s.imageRadius)&&void 0!==u?u:8,W=null!==(c=null===(d=ie.default)||void 0===d?void 0:d.imageGap)&&void 0!==c?c:12,H=L(ie,"region",N),O=(L(ie,"year",N),L(ie,"dam",N));return(0,e.jsx)("div",{className:"dam-card",key:r,style:w(ie,N,ee),tabIndex:0,onMouseEnter:()=>Y(r),onMouseLeave:()=>Y(null),onClick:()=>se(I),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),se(C))}},(0,e.jsx)("div",{style:{width:"100%",height:R+"px",overflow:"hidden",borderRadius:P+"px",marginBottom:W+"px",position:"relative"}},(0,e.jsx)("img",{key:`${r}-${ee}-${oe}`,src:U,alt:C,style:{width:"100%",height:"100%",objectFit:"cover",transition:"transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)",transform:N?"scale(1.15)":"scale(1)"},onError:e=>{e.target.src=x(o.context,ee)}}),(0,e.jsx)("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"50%",background:"linear-gradient(transparent, rgba(0,0,0,0.1))",pointerEvents:"none"}})),(0,e.jsx)("div",{style:{width:"100%",textAlign:"left",flex:"1",display:"flex",flexDirection:"column",justifyContent:"flex-start"}},(0,e.jsx)("div",{style:{display:"flex",alignItems:"center",marginBottom:"4px"}},(0,e.jsx)("span",{style:{fontSize:(null!==(f=H.fontSize)&&void 0!==f?f:12)+"px",color:A(H.textColor,ee)||(N?A(null===(v=ie.hover)||void 0===v?void 0:v.textColor,ee)||"#3b82f6":"#64748b"),fontWeight:null!==(m=H.fontWeight)&&void 0!==m?m:500,lineHeight:H.lineHeight?H.lineHeight.toString():"1.2",letterSpacing:void 0!==H.letterSpacing?H.letterSpacing+"px":"0.025em",textTransform:"uppercase",transition:"color 0.3s ease"}},T)),(0,e.jsx)("div",{style:{fontSize:(null!==(p=O.fontSize)&&void 0!==p?p:14)+"px",fontWeight:null!==(g=O.fontWeight)&&void 0!==g?g:N?null!==(y=null===(h=ie.hover)||void 0===h?void 0:h.fontWeight)&&void 0!==y?y:600:null!==(S=null===(b=ie.default)||void 0===b?void 0:b.fontWeight)&&void 0!==S?S:500,color:A(O.textColor,ee)||(N?A(null===(z=ie.hover)||void 0===z?void 0:z.textColor,ee)||"#3b82f6":A(null===(k=ie.default)||void 0===k?void 0:k.textColor,ee)||"#1e293b"),lineHeight:O.lineHeight?O.lineHeight.toString():"1.4",letterSpacing:void 0!==O.letterSpacing?O.letterSpacing+"px":"normal",overflow:"hidden"}},C)))}))})())):(0,e.jsx)("div",{className:"widget-custom jimu-widget dam-gallery",style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",padding:"40px 20px",fontFamily:"system-ui, -apple-system, sans-serif"}},(0,e.jsx)("div",{style:{background:null!==(v=A(ie.parentBackgroundColor,ee))&&void 0!==v?v:"#f8fafc",padding:"32px",borderRadius:"16px",border:"1px solid #e2e8f0",boxShadow:"0 4px 16px rgba(0,0,0,0.1)"}},(0,e.jsx)("p",{style:{margin:"0 0 8px 0",fontWeight:600,fontSize:"18px",color:null!==(p=A(null===(m=ie.default)||void 0===m?void 0:m.textColor,ee))&&void 0!==p?p:"#1e293b"}},"ru"===K?"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω":"uz"===K?"Foydalanuvchi avtorizatsiya qilinmagan":"–§–æ–π–¥–∞–ª–∞–Ω—É–≤—á–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è “õ–∏–ª–∏–Ω–º–∞–≥–∞–Ω"),(0,e.jsx)("small",{style:{opacity:.7,fontSize:"14px",color:null!==(h=A(null===(g=ie.default)||void 0===g?void 0:g.textColor,ee))&&void 0!==h?h:"#64748b"}},"ru"===K?"–í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–ª–æ—Ç–∏–Ω":"uz"===K?"To'g'onlarni ko'rish uchun tizimga kiring":"–¢—û“ì–æ–Ω–ª–∞—Ä–Ω–∏ –∫—û—Ä–∏—à —É—á—É–Ω —Ç–∏–∑–∏–º–≥–∞ –∫–∏—Ä–∏–Ω–≥")))};function N(e){n.p=e}})(),i})())}}}));