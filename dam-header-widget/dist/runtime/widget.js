/*! For license information please see widget.js.LICENSE.txt */
System.register(["jimu-core","jimu-core/react"],(function(e,t){var r={},o={};return{setters:[function(e){r.DataSourceComponent=e.DataSourceComponent,r.DataSourceManager=e.DataSourceManager,r.jimuHistory=e.jimuHistory,r.jsx=e.jsx},function(e){o.createElement=e.createElement,o.forwardRef=e.forwardRef,o.useEffect=e.useEffect,o.useState=e.useState}],execute:function(){e((()=>{var e={3541:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var o=r(8081),a=r.n(o),n=r(3645),i=r.n(n)()(a());i.push([e.id,'.dam-header-widget{width:100%;height:100%;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;background:var(--header-bg-color, #ffffff);border-radius:var(--header-border-radius, 0);box-shadow:var(--header-box-shadow, none);overflow:hidden;display:flex;flex-direction:column}.dam-header-widget[data-theme=dark]{--header-bg-color: #2d2d2d;--header-text-color: #ffffff;--header-top-strip-color: #666666;--header-separator-color: #555555;--header-border-color: #666666}.dam-header-widget[data-theme=dark] .dam-header-button{color:#fff}.dam-header-widget[data-theme=dark] .dam-header-button:hover{opacity:.8}.dam-header-widget[data-theme=dark] .dam-header-year-selector{border-color:#666;color:#fff}.dam-header-widget[data-theme=dark] .dam-header-year-selector:hover{background:rgba(255,255,255,.1);border-color:#888}.dam-header-container{width:100%;flex:1;display:flex;flex-direction:column}.dam-header-top-strip{height:4px;background:var(--header-top-strip-color, #4a4a4a);width:100%}.dam-header-content{display:flex;align-items:center;justify-content:space-between;padding:var(--header-padding, 0 20px);min-height:var(--header-height, 60px);flex:1}.dam-header-left,.dam-header-center,.dam-header-right{display:flex;align-items:center;gap:12px}.dam-header-center{flex:1;justify-content:center}.dam-header-title{margin:0;font-size:var(--header-title-font-size, 18px);font-weight:var(--header-title-font-weight, bold);color:var(--header-text-color, #333333);text-align:center}.dam-header-button{display:flex;align-items:center;gap:6px;background:none;border:none;color:var(--header-text-color, #333333);font-size:18px;cursor:pointer;transition:all .2s ease}.dam-header-button:hover{opacity:.8}.dam-header-button:disabled{cursor:not-allowed;color:#888;opacity:.6}.dam-header-icon{display:flex;align-items:center;justify-content:center}.dam-header-year-selector{display:flex;align-items:center;gap:8px;padding:8px 16px;background:rgba(0,0,0,0);border:1px solid #e0e0e0;border-radius:6px;color:var(--header-text-color, #333333);font-size:var(--header-font-size, 14px);cursor:pointer;transition:all .2s ease;min-width:80px;justify-content:center}.dam-header-year-selector:hover{background:#f5f5f5;border-color:#d0d0d0}.dam-header-separator{margin:0;border:none;height:1px;background:var(--header-separator-color, #e0e0e0)}@media(max-width: 768px){.dam-header-content{flex-direction:column;gap:16px;padding:16px}.dam-header-left,.dam-header-center,.dam-header-right{width:100%;justify-content:center}.dam-header-title{font-size:16px}}',""]);const l=i},3645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",o=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),o&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),o&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,o,a,n){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(o)for(var l=0;l<this.length;l++){var d=this[l][0];null!=d&&(i[d]=!0)}for(var s=0;s<e.length;s++){var c=[].concat(e[s]);o&&i[c[0]]||(void 0!==n&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=n),r&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=r):c[2]=r),a&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=a):c[4]="".concat(a)),t.push(c))}},t}},8081:e=>{"use strict";e.exports=function(e){return e[1]}},3379:e=>{"use strict";var t=[];function r(e){for(var r=-1,o=0;o<t.length;o++)if(t[o].identifier===e){r=o;break}return r}function o(e,o){for(var n={},i=[],l=0;l<e.length;l++){var d=e[l],s=o.base?d[0]+o.base:d[0],c=n[s]||0,u="".concat(s," ").concat(c);n[s]=c+1;var f=r(u),p={css:d[1],media:d[2],sourceMap:d[3],supports:d[4],layer:d[5]};if(-1!==f)t[f].references++,t[f].updater(p);else{var h=a(p,o);o.byIndex=l,t.splice(l,0,{identifier:u,updater:h,references:1})}i.push(u)}return i}function a(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,a){var n=o(e=e||[],a=a||{});return function(e){e=e||[];for(var i=0;i<n.length;i++){var l=r(n[i]);t[l].references--}for(var d=o(e,a),s=0;s<n.length;s++){var c=r(n[s]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}n=d}}},569:e=>{"use strict";var t={};e.exports=function(e,r){var o=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(r)}},9216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:(e,t,r)=>{"use strict";e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},7795:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var o="";r.supports&&(o+="@supports (".concat(r.supports,") {")),r.media&&(o+="@media ".concat(r.media," {"));var a=void 0!==r.layer;a&&(o+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),o+=r.css,a&&(o+="}"),r.media&&(o+="}"),r.supports&&(o+="}");var n=r.sourceMap;n&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),t.styleTagTransform(o,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},4589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},8891:e=>{"use strict";e.exports=r},1315:e=>{"use strict";e.exports=o}},t={};function a(r){var o=t[r];if(void 0!==o)return o.exports;var n=t[r]={id:r,exports:{}};return e[r](n,n.exports,a),n.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.p="",a.nc=void 0;var n={};return a.p=window.jimuConfig.baseUrl,(()=>{"use strict";a.r(n),a.d(n,{__set_webpack_public_path__:()=>I,default:()=>D});var e=a(8891),t=a(1315);const r={uz:{_widgetLabel:"Bogʻ maʼlumotlari sarlavhasi",downloadPassport:"Pasportni yuklab olish",close:"Yopish",year:"Yil",selectYear:"Yilni tanlang",damNames:{chorvoq:"Chorvoq suv ombori",ohangaron:"Ohangaron suv ombori",tashkent:"Tashkent suv ombori"}},uzcryl:{_widgetLabel:"Боғ маълумотлари сарлавҳаси",downloadPassport:"Паспортни юклаб олиш",close:"Ёпиш",year:"Йил",selectYear:"Йилни танланг",damNames:{chorvoq:"Чорвоқ сув омбори",ohangaron:"Оҳангарон сув омбори",tashkent:"Тошкент сув омбори"}},ru:{_widgetLabel:"Заголовок информации о водохранилище",downloadPassport:"Скачать паспорт",close:"Закрыть",year:"Год",selectYear:"Выберите год",damNames:{chorvoq:"Чарвакское водохранилище",ohangaron:"Ахангаранское водохранилище",tashkent:"Ташкентское водохранилище"}}};var o=a(3379),i=a.n(o),l=a(7795),d=a.n(l),s=a(569),c=a.n(s),u=a(3565),f=a.n(u),p=a(9216),h=a.n(p),m=a(4589),g=a.n(m),v=a(3541),b={};b.styleTagTransform=g(),b.setAttributes=f(),b.insert=c().bind(null,"head"),b.domAPI=d(),b.insertStyleElement=h(),i()(v.Z,b),v.Z&&v.Z.locals&&v.Z.locals;const y=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,((e,t,r)=>r?r.toUpperCase():t.toLowerCase())))(e);return t.charAt(0).toUpperCase()+t.slice(1)},x=(...e)=>e.filter(((e,t,r)=>Boolean(e)&&""!==e.trim()&&r.indexOf(e)===t)).join(" ").trim(),w=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var S={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const k=(0,t.forwardRef)((({color:e="currentColor",size:r=24,strokeWidth:o=2,absoluteStrokeWidth:a,className:n="",children:i,iconNode:l,...d},s)=>(0,t.createElement)("svg",{ref:s,...S,width:r,height:r,stroke:e,strokeWidth:a?24*Number(o)/Number(r):o,className:x("lucide",n),...!i&&!w(d)&&{"aria-hidden":"true"},...d},[...l.map((([e,r])=>(0,t.createElement)(e,r))),...Array.isArray(i)?i:[i]]))),C=(e,r)=>{const o=(0,t.forwardRef)((({className:o,...a},n)=>{return(0,t.createElement)(k,{ref:n,iconNode:r,className:x(`lucide-${i=y(e),i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,o),...a});var i}));return o.displayName=y(e),o},E=C("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),_=C("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var j=function(e,t,r,o){return new(r||(r=Promise))((function(a,n){function i(e){try{d(o.next(e))}catch(e){n(e)}}function l(e){try{d(o.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,l)}d((o=o.apply(e,t||[])).next())}))};const L={SELECTED_YEAR:"selected-year",SELECTED_DAM:"selected_dam",DAM_SORT_ORDER:"dam-sort-order",SELECTED_REGION:"selected-region",CUSTOM_LOCALE:"custom_locale"};function z(e){return localStorage.getItem(e)}function T(){try{const e=localStorage.getItem("exb_auth");if(e)try{const t=JSON.parse(e);if(t.email)return t.email;if(t.user&&t.user.email)return t.user.email;if(t.username&&t.username.includes("@"))return t.username}catch(e){}const t=Object.keys(localStorage).filter((e=>e.includes("portalApp")||e.includes("portal")||e.includes("token")||e.includes("credential")));for(const e of t)try{const t=localStorage.getItem(e),r=JSON.parse(t||"{}");if(r.email)return r.email}catch(e){e instanceof Error&&e.message;continue}const r=Object.keys(localStorage);for(const e of r)try{const t=localStorage.getItem(e);if(t&&(t.includes('"email"')||t.includes("farhodmf")||t.includes("@"))){const e=JSON.parse(t);if(e.email)return e.email}}catch(t){const r=localStorage.getItem(e);if(r&&r.includes("@")&&r.length<100)return r;continue}return null}catch(e){return null}}function D(o){var a,n,i,l,d,s;const[c,u]=(0,t.useState)([]),[f,p]=(0,t.useState)([]),[h,m]=(0,t.useState)(null),[g,v]=(0,t.useState)(null),[b,y]=(0,t.useState)("uz"),[x,w]=(0,t.useState)("light"),[S,k]=(0,t.useState)(""),[C,D]=(0,t.useState)(!1),[I,N]=(0,t.useState)(!1),[R,A]=(0,t.useState)(null),[O,$]=(0,t.useState)(!0),[F,M]=(0,t.useState)();(0,t.useEffect)((()=>{}),[o.context]);const U=null===(a=o.useDataSources)||void 0===a?void 0:a[0],P=o.config;(0,t.useEffect)((()=>{let e,t,r,o;function a(e){switch(e.key){case L.SELECTED_YEAR:v(e.newValue);break;case L.SELECTED_DAM:e.newValue&&W(e.newValue);break;case L.CUSTOM_LOCALE:y(e.newValue||"uz");break;case"customTheme":w(e.newValue||"light")}}return window.addEventListener("storage",a),e=setInterval((()=>{const e=z(L.SELECTED_YEAR);e!==g&&v(e)}),100),t=setInterval((()=>{const e=z(L.SELECTED_DAM);e&&e!==h&&W(e)}),100),r=setInterval((()=>{const e=z(L.CUSTOM_LOCALE)||"uz";e!==b&&y(e)}),100),o=setInterval((()=>{const e=z("customTheme")||"light";e!==x&&w(e)}),100),()=>{window.removeEventListener("storage",a),clearInterval(e),clearInterval(t),clearInterval(r),clearInterval(o)}}),[g,h,b,x]),(0,t.useEffect)((()=>{v(z(L.SELECTED_YEAR)),y(z(L.CUSTOM_LOCALE)||"uz"),w(z("customTheme")||"light");const e=z(L.SELECTED_DAM);e&&""!==e.trim()&&(m(e),H(e,z(L.CUSTOM_LOCALE)||"uz"))}),[]),(0,t.useEffect)((()=>{!function(){j(this,void 0,void 0,(function*(){$(!0);try{const e=yield function(){return j(this,arguments,void 0,(function*(e=3,t=1e3){let r=T();if(r)return r;for(let o=1;o<=e;o++)if(yield new Promise((e=>setTimeout(e,t))),r=T(),r)return r;return null}))}(3,1e3);A(e)}catch(e){A(null)}finally{$(!1)}}))}()}),[]),(0,t.useEffect)((()=>{if(R||O)return;const e=setInterval((()=>{const t=T();t&&(A(t),clearInterval(e))}),2e3),t=setTimeout((()=>{clearInterval(e)}),3e4);return()=>{clearInterval(e),clearTimeout(t)}}),[R,O]);const W=e=>{e&&e!==h?(m(e),H(e,b)):!e&&h&&""===e&&(m(null),k(""))},H=(e,t)=>{try{if(c.length>0){const t=(null==P?void 0:P.damField)||"name",r=c.find((r=>{const o=r.getFieldValue(t);return o&&String(o).toLowerCase()===String(e).toLowerCase()}));if(r){const t=function(e,t){var r,o;if(!e)return t;const a=(null===(o=null===(r=e.getData())||void 0===r?void 0:r.feature)||void 0===o?void 0:o.attributes)||e.getData()||{};let n=a.name||t;return"ru"===b&&a.title_ru?n=a.title_ru:"uz"===b&&a.title_uz_l?n=a.title_uz_l:"uzcryl"===b&&a.title_uz_c&&(n=a.title_uz_c),n}(r,e);return void k(t)}}k("")}catch(t){k(e)}},Y=e=>{var t,o,a,n;const i=null===(o=null===(t=null==P?void 0:P.localization)||void 0===t?void 0:t[e])||void 0===o?void 0:o[b];if("string"==typeof i)return i;const l=null===(a=r[b])||void 0===a?void 0:a[e];if("string"==typeof l)return l;const d=null===(n=r.uz)||void 0===n?void 0:n[e];return"string"==typeof d?d:e};(0,t.useEffect)((()=>{if(!R)return void p([]);const e=(null==P?void 0:P.yearField)||"year",t=(null==P?void 0:P.userAccessField)||"allowed_users",r=function(e,t,r){return t?t.toLowerCase().includes("admin")||t.toLowerCase().includes("farhodmf")?e:e.filter((e=>function(e,t,r){if(!t||!e)return!1;const o=e.getFieldValue(r);return!!o&&o.split(",").map((e=>e.trim().toLowerCase())).includes(t.toLowerCase())}(e,t,r))):[]}(c,R,t),o=function(e,t,r){return r&&"All"!==r?e.filter((e=>e.getFieldValue(t)===r)):e}(r,e,g);p(o),h&&o.length>0&&H(h,b)}),[c,R,g,h,b,null==P?void 0:P.yearField]),(0,t.useEffect)((()=>{h&&H(h,b)}),[h,b]),(0,t.useEffect)((()=>{h&&c.length>0&&H(h,b)}),[c,h,b]),(0,t.useEffect)((()=>{if(!F||!h)return;const e=(null==P?void 0:P.damField)||"name",t=`${e} = '${h}'`,r=[e,"title_uz_l","title_uz_c","title_ru"];F.query({where:t,outFields:r,pageSize:1e3,returnGeometry:!1}).then((e=>{const t=e.records||[];t.length>0?(u(t),p(t),H(h,b)):(u([]),p([]))})).catch((e=>{u([]),p([])}))}),[F,h,null==P?void 0:P.damField]),(0,t.useEffect)((()=>{const e=z(L.SELECTED_DAM);e&&""!==e.trim()&&e!==h&&f.length>0&&W(e)}),[f,h]);const B=()=>j(this,void 0,void 0,(function*(){if(!(null==P?void 0:P.apiEndpoint))return!1;const e=`${G(P.apiEndpoint,"passport")}?dam=${encodeURIComponent(h||"")}&year=${encodeURIComponent(String(g||""))}`,t=yield fetch(e,{method:"GET",headers:Object.assign({},P.apiHeaders||{})});if(!t.ok)return!1;const r=yield t.blob();return 0!==r.size&&(J(r,`passport_${h||"unknown"}_${g||"unknown"}.pdf`),!0)})),q=()=>j(this,void 0,void 0,(function*(){var t;if(!(null==U?void 0:U.dataSourceId))return!1;const r=e.DataSourceManager.getInstance().getDataSource(U.dataSourceId);if(!r)return!1;const a=["dam_key","dam","dam_id","name","title","damb","damb_key"];try{const e=yield null==r?void 0:r.load({where:"1=1",outFields:["*"],returnGeometry:!1},{widgetId:o.id});let n;if((null==e?void 0:e.length)&&(n=null!==(t=e.find((e=>{const t=e.getData();return a.some((e=>{const r=null==t?void 0:t[e];return r&&String(r).toLowerCase()===String(h).toLowerCase()}))})))&&void 0!==t?t:e[0]),!n)return!1;const i=n.getData(),l=["passport_url","passportUrl","passport_pdf","passport","pdf_url"].map((e=>null==i?void 0:i[e])).find((e=>"string"==typeof e&&/^https?:\/\//i.test(e)));if(l){const e=yield(yield fetch(l)).blob();if(e.size>0)return J(e,K(l)||"passport.pdf"),!0}return!1}catch(e){return!1}})),V=()=>j(this,void 0,void 0,(function*(){if(!h)return!1;try{const e=z(L.CUSTOM_LOCALE)||"uz";let t=function(e,t){if(!e||!(null==t?void 0:t.folderUrl))return null;const r=e.toLowerCase().replace(/[^a-z0-9]/g,"");return`${t.folderUrl.replace("/experience/../","/")}dist/runtime/assets/${r}.pdf`}(h,o.context);if(!t){const e=h.toLowerCase().replace(/[^a-z0-9]/g,"");t=`${window.location.origin}/widgets/dam-header-widget/dist/runtime/assets/${e}.pdf`}if(window.location.origin,h.toLowerCase().replace(/[^a-z0-9]/g,""),yield Z(t)){const r=yield fetch(t);if(r.ok){const t=yield r.blob();if(t.size>0)return J(t,`passport_${h}_${e}.pdf`),!0}}return!1}catch(e){return!1}})),Z=e=>j(this,void 0,void 0,(function*(){try{return(yield fetch(e,{method:"HEAD"})).ok}catch(e){return!1}})),G=(e,t)=>e?`${e.replace(/\/+$/,"")}/${t.replace(/^\/+/,"")}`:t,J=(e,t)=>{const r=document.createElement("a"),o=URL.createObjectURL(e);r.href=o,r.download=t,document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(o)},K=e=>{try{return(new URL(e).pathname.split("/").pop()||"").split("?")[0]||null}catch(e){return null}};return O?(0,e.jsx)("div",{className:"jimu-widget",style:{background:"#fff",color:"#000",width:"100%",height:"60px",padding:"20px",margin:"0",position:"relative",fontSize:"14px",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center"}},(0,e.jsx)("div",null,(0,e.jsx)("p",{style:{margin:"0 0 8px 0",fontWeight:600}},(null===(i=null===(n=null==P?void 0:P.localization)||void 0===n?void 0:n.checkingAuth)||void 0===i?void 0:i[b])||("ru"===b?"Проверка авторизации...":"uz"===b?"Avtorizatsiya tekshirilmoqda...":"Авторизация текширилмоқда...")),(0,e.jsx)("small",{style:{opacity:.7}},(null===(d=null===(l=null==P?void 0:P.localization)||void 0===l?void 0:l.pleaseWait)||void 0===d?void 0:d[b])||("ru"===b?"Пожалуйста, подождите":"uz"===b?"Iltimos kuting":"Илтимос кутинг")))):C?(0,e.jsx)("div",{className:"dam-header-widget-error",style:{padding:20,textAlign:"center",color:"#721c24",backgroundColor:"#f8d7da",border:"1px solid #f5c6cb",borderRadius:8,margin:10}},(0,e.jsx)("h3",null,"Something went wrong"),(0,e.jsx)("p",null,"Please refresh the page or contact support."),(0,e.jsx)("button",{onClick:()=>D(!1),style:{background:"#dc3545",color:"white",border:"none",padding:"8px 16px",borderRadius:6,cursor:"pointer"}},"Try Again")):(0,e.jsx)("div",{className:`dam-header-widget ${(null===(s=null==P?void 0:P.styleConfig)||void 0===s?void 0:s.customClass)||""}`,"data-theme":x||"light",style:(()=>{var e,t,r,o,a;const n=(null==P?void 0:P.styleConfig)||{},i="dark"===(x||"light"),l=(e,t,r)=>{var o;const a=t?n[t]:void 0;return i&&null!=a?a:null!==(o=n[e])&&void 0!==o?o:r},d=l("backgroundColor","backgroundColorDark","#ffffff"),s=l("topStripColor","topStripColorDark","#4a4a4a"),c=l("separatorColor","separatorColorDark","#e0e0e0"),u=l("textColor","textColorDark","#333333"),f=l("titleColor","titleColorDark","#111111"),p=l("borderColor","borderColorDark","transparent"),h=!!n.enableGradient,m=l("gradientFrom","gradientFromDark",d),g=l("gradientTo","gradientToDark",d),v=Number(null!==(e=n.gradientAngle)&&void 0!==e?e:0),b=n.shadowPreset||"none",y=null!==(r=null!==(t=n.boxShadow)&&void 0!==t?t:{none:"none",soft:"0 4px 16px rgba(0,0,0,.08)",medium:"0 6px 24px rgba(0,0,0,.12)",strong:"0 10px 32px rgba(0,0,0,.18)",ambient:"0 2px 0 rgba(0,0,0,.06), 0 8px 24px rgba(0,0,0,.12)"}[b])&&void 0!==r?r:"none",w=Number(null!==(o=n.borderWidth)&&void 0!==o?o:0),S=Number(null!==(a=n.backdropBlur)&&void 0!==a?a:0),k=h?`linear-gradient(${v}deg, ${m}, ${g})`:d;return{"--header-height":n.headerHeight||"60px","--header-padding":n.padding||"0 20px","--gap":n.gap||"8px","--header-bg-color":k,"--header-top-strip-color":s,"--header-separator-color":c,"--header-text-color":u,"--header-title-color":f,"--header-font-size":n.fontSize||"14px","--header-title-font-size":n.titleFontSize||"18px","--header-font-weight":n.fontWeight||"normal","--header-title-font-weight":n.titleFontWeight||"bold","--font-family":n.fontFamily||"Inter, system-ui, sans-serif","--title-font-family":n.titleFontFamily||"Inter, system-ui, sans-serif","--line-height":n.lineHeight||"1.4","--letter-spacing":n.letterSpacing||"0","--title-letter-spacing":n.titleLetterSpacing||"0","--title-transform":n.titleTransform||"none","--header-border-color":p,"--header-border-width":`${w}px`,"--header-border-radius":n.borderRadius||"0","--radius-tl":n.borderTopLeftRadius||"0","--radius-tr":n.borderTopRightRadius||"0","--radius-br":n.borderBottomRightRadius||"0","--radius-bl":n.borderBottomLeftRadius||"0","--header-box-shadow":y,"--backdrop-blur":`${S}px`}})()},U&&(0,e.jsx)(e.DataSourceComponent,{useDataSource:U,widgetId:o.id,onDataSourceCreated:e=>{M(e),h&&setTimeout((()=>{const t=(null==P?void 0:P.damField)||"name",r=`${t} = '${h}'`,o=[t,"title_uz_l","title_uz_c","title_ru"];e.query({where:r,outFields:o,pageSize:1e3,returnGeometry:!1}).then((e=>{const t=e.records||[];t.length>0&&(u(t),p(t),h&&H(h,b))})).catch((e=>{}))}),100)}}),(0,e.jsx)("div",{className:"dam-header-container",style:{position:"relative",height:"var(--header-height)",padding:"var(--header-padding)",color:"var(--header-text-color)",background:"var(--header-bg-color)",display:"grid",gridTemplateColumns:"auto 1fr auto",alignItems:"center",gap:"var(--gap)",borderWidth:"var(--header-border-width)",borderStyle:"solid",borderColor:"var(--header-border-color)",borderRadius:"var(--header-border-radius)",boxShadow:"var(--header-box-shadow)",backdropFilter:"blur(var(--backdrop-blur))",WebkitBackdropFilter:"blur(var(--backdrop-blur))"}},(0,e.jsx)("div",{className:"dam-header-top-strip",style:{position:"absolute",left:0,right:0,top:0,height:3,background:"var(--header-top-strip-color)",borderTopLeftRadius:"var(--radius-tl)",borderTopRightRadius:"var(--radius-tr)"}}),(0,e.jsx)("div",{className:"dam-header-left",style:{display:"flex",alignItems:"center",gap:"8px"}},(0,e.jsx)("button",{className:"dam-header-button",onClick:()=>j(this,void 0,void 0,(function*(){try{if(N(!0),yield V())return void N(!1);if(yield B())return void N(!1);if(yield q())return void N(!1);alert("PDF topilmadi / Не найден PDF / PDF not found"),N(!1)}catch(e){alert("Yuklab olishda xatolik / Ошибка скачивания / Download error"),N(!1)}})),title:Y("downloadPassport"),disabled:!!I,style:Object.assign(Object.assign({},{display:"inline-flex",alignItems:"center",gap:6,border:"none",background:"none",fontSize:18,color:"var(--header-text-color)",cursor:"pointer"}),{cursor:I?"not-allowed":"pointer",color:I?"#888":"var(--header-text-color)",opacity:I?.6:1})},(0,e.jsx)("div",{className:"dam-header-icon",style:{display:"flex"}},(0,e.jsx)(E,{size:20})),(0,e.jsx)("span",{style:{whiteSpace:"nowrap"}},I?(()=>{var e,t;return(null===(t=null===(e=null==P?void 0:P.localization)||void 0===e?void 0:e.loading)||void 0===t?void 0:t[b])||("ru"===b?"Загрузка...":"uzcryl"===b?"Юкланмоқда...":"Yuklanmoqda...")})():Y("downloadPassport")))),(0,e.jsx)("div",{className:"dam-header-center",style:{textAlign:"center"}},(0,e.jsx)("h1",{className:"dam-header-title",style:{margin:0,fontSize:"var(--header-title-font-size)",fontWeight:"var(--header-title-font-weight)",color:"var(--header-title-color)",fontFamily:"var(--title-font-family)",letterSpacing:"var(--title-letter-spacing)",textTransform:"var(--title-transform)",lineHeight:"var(--line-height)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:S},S)),(0,e.jsx)("div",{className:"dam-header-right",style:{display:"flex",alignItems:"center",justifyContent:"flex-end"}},(0,e.jsx)("button",{className:"dam-header-button",onClick:()=>{(()=>{var t,r;const a=(null===(r=null===(t=o.config)||void 0===t?void 0:t.linkConfig)||void 0===r?void 0:r.value)||"region-filter";let n=!1;try{e.jimuHistory.changePage(a),n=!0}catch(e){console.error("🔄 Navigation: jimuHistory failed, trying URL-based navigation:",e)}if(!n)try{const e=window.location.href,t=new URLSearchParams(window.location.search);t.set("page",a);const r=`${e.split("?")[0]}?${t.toString()}`;window.location.href=r,n=!0}catch(e){console.error("🔄 Navigation: All navigation methods failed:",e)}n||(console.error("🔄 Navigation: No navigation method succeeded"),window.history.back())})()},title:Y("close"),style:{display:"inline-flex",alignItems:"center",gap:6,border:"none",background:"none",fontSize:18,color:"var(--header-text-color)",cursor:"pointer"}},(0,e.jsx)("div",{className:"dam-header-icon",style:{display:"flex"}},(0,e.jsx)(_,{size:20})),(0,e.jsx)("span",{style:{whiteSpace:"nowrap"}},Y("close"))))),(0,e.jsx)("hr",{className:"dam-header-separator",style:{width:"100%",border:0,height:1,background:"var(--header-separator-color)",margin:0,borderBottomLeftRadius:"var(--radius-bl)",borderBottomRightRadius:"var(--radius-br)"}}))}function I(e){a.p=e}})(),n})())}}}));