System.register(["jimu-core","jimu-ui/advanced/data-source-selector","jimu-ui","jimu-ui/basic/color-picker"],(function(e,t){var a={},s={},o={},r={};return{setters:[function(e){a.DataSourceManager=e.DataSourceManager,a.DataSourceTypes=e.DataSourceTypes,a.Immutable=e.Immutable,a.React=e.React,a.jsx=e.jsx},function(e){s.DataSourceSelector=e.DataSourceSelector},function(e){o.Button=e.Button,o.NumericInput=e.NumericInput,o.Select=e.Select,o.TextInput=e.TextInput},function(e){r.ColorPicker=e.ColorPicker}],execute:function(){e((()=>{var e={79244:e=>{"use strict";e.exports=a},14321:e=>{"use strict";e.exports=o},13089:e=>{"use strict";e.exports=s},54337:e=>{"use strict";e.exports=r}},t={};function i(a){var s=t[a];if(void 0!==s)return s.exports;var o=t[a]={exports:{}};return e[a](o,o.exports,i),o.exports}i.d=(e,t)=>{for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="";var n={};return i.p=window.jimuConfig.baseUrl,(()=>{"use strict";i.r(n),i.d(n,{__set_webpack_public_path__:()=>p,default:()=>u});var e=i(79244),t=i(13089),a=i(14321),s=i(54337);const o={background:"#28292d",borderRadius:12,padding:18,marginBottom:22,boxShadow:"0 1px 3px rgba(0,0,0,0.07)",border:"1px solid #23262f22"},r={display:"flex",flexDirection:"column",gap:4,marginBottom:14},l={fontWeight:500,fontSize:14,marginBottom:2,color:"#f3f3f3"};class u extends e.React.PureComponent{constructor(t){super(t),this.supportedTypes=(0,e.Immutable)([e.DataSourceTypes.FeatureLayer]),this.updateAvailableFields=()=>{var t;const a=null===(t=this.props.useDataSources)||void 0===t?void 0:t[0];if(!a)return void this.setState({availableFields:[]});const s=e.DataSourceManager.getInstance().getDataSource(a.dataSourceId),o=null==s?void 0:s.getSchema(),r=(null==o?void 0:o.fields)?Object.values(o.fields).map((e=>({name:e.jimuName||e.name,alias:e.alias||e.jimuName||e.name}))):[];this.setState({availableFields:r})},this.updateProp=(e,t)=>{this.props.onSettingChange({id:this.props.id,config:Object.assign(Object.assign({},this.props.config),{[e]:t})})},this.onDataSourceChange=e=>{this.props.onSettingChange({id:this.props.id,useDataSources:e}),setTimeout(this.updateAvailableFields,200)},this.addBar=()=>{var e;const{availableFields:t}=this.state,a={field:(null===(e=t[0])||void 0===e?void 0:e.name)||"",color:"#299AFF",label_ru:"",label_uz:"",label_uzcryl:""},s=Array.isArray(this.props.config.bars)?[...this.props.config.bars,a]:[a];this.updateProp("bars",s)},this.updateBar=(e,t,a)=>{const s=Array.isArray(this.props.config.bars)?[...this.props.config.bars]:[];s[e]=Object.assign(Object.assign({},s[e]),{[t]:a}),this.updateProp("bars",s)},this.removeBar=e=>{const t=Array.isArray(this.props.config.bars)?[...this.props.config.bars]:[];t.splice(e,1),this.updateProp("bars",t)},this.state={availableFields:[]}}componentDidMount(){this.updateAvailableFields()}componentDidUpdate(e){e.useDataSources!==this.props.useDataSources&&this.updateAvailableFields()}render(){var i,n,u,p,d,c;const{config:x,useDataSources:j}=this.props,{availableFields:g}=this.state,v=Array.isArray(x.bars)?x.bars:[];return(0,e.jsx)("div",{style:{fontSize:14,color:"#fff",background:"#212126"}},(0,e.jsx)("div",{style:o},(0,e.jsx)("div",{style:r},(0,e.jsx)("span",{style:l},"\u0418\u0441\u0442\u043e\u0447\u043d\u0438\u043a \u0434\u0430\u043d\u043d\u044b\u0445"),(0,e.jsx)(t.DataSourceSelector,{mustUseDataSource:!0,types:this.supportedTypes,useDataSources:j,onChange:this.onDataSourceChange,widgetId:this.props.id}))),(0,e.jsx)("div",{style:o},(0,e.jsx)("div",{style:r},(0,e.jsx)("span",{style:l},"\u041f\u043e\u043b\u0435 \u0434\u043b\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430 \u0434\u0430\u043c\u0431\u044b"),(0,e.jsx)(a.Select,{value:x.damFilterField||(g.find((e=>"title"===e.name))?"title":(null===(i=g[0])||void 0===i?void 0:i.name)||""),onChange:e=>this.updateProp("damFilterField",e.target.value)},g.map((t=>(0,e.jsx)("option",{key:t.name,value:t.name},t.alias)))))),g.length>0&&(0,e.jsx)("div",{style:o},(0,e.jsx)("div",{style:Object.assign(Object.assign({},l),{fontSize:16,marginBottom:8})},"\u0411\u0430\u0440\u044b \u0434\u0438\u0430\u0433\u0440\u0430\u043c\u043c\u044b"),v.map(((t,o)=>(0,e.jsx)("div",{key:o,style:Object.assign(Object.assign({},r),{border:"1px solid #292929",borderRadius:8,marginBottom:10,padding:10,background:"#262729"})},(0,e.jsx)("span",{style:Object.assign(Object.assign({},l),{fontSize:14,marginBottom:4})},"\u0411\u0430\u0440 ",o+1),(0,e.jsx)("div",{style:r},(0,e.jsx)("span",{style:l},"\u041f\u043e\u043b\u0435 \u0434\u0430\u043d\u043d\u044b\u0445"),(0,e.jsx)(a.Select,{value:t.field,onChange:e=>this.updateBar(o,"field",e.target.value)},g.map((t=>(0,e.jsx)("option",{key:t.name,value:t.name},t.alias))))),(0,e.jsx)("div",{style:r},(0,e.jsx)("span",{style:l},"\u0426\u0432\u0435\u0442 \u0431\u0430\u0440\u0430"),(0,e.jsx)(s.ColorPicker,{color:t.color||"#299AFF",onChange:e=>this.updateBar(o,"color",e)})),(0,e.jsx)("div",{style:r},(0,e.jsx)("span",{style:l},"\u041b\u0435\u0439\u0431\u043b (RU)"),(0,e.jsx)(a.TextInput,{value:t.label_ru||"",onChange:e=>this.updateBar(o,"label_ru",e.target.value)}),(0,e.jsx)("span",{style:l},"\u041b\u0435\u0439\u0431\u043b (UZ)"),(0,e.jsx)(a.TextInput,{value:t.label_uz||"",onChange:e=>this.updateBar(o,"label_uz",e.target.value)}),(0,e.jsx)("span",{style:l},"\u041b\u0435\u0439\u0431\u043b (UZCRYL)"),(0,e.jsx)(a.TextInput,{value:t.label_uzcryl||"",onChange:e=>this.updateBar(o,"label_uzcryl",e.target.value)}),(0,e.jsx)("span",{style:l},"\u0410\u0442\u0440\u0438\u0431\u0443\u0442 \u0434\u043b\u044f \u043b\u0435\u0439\u0431\u043b\u0430"),(0,e.jsx)(a.Select,{value:t.attributeField||"",onChange:e=>this.updateBar(o,"attributeField",e.target.value)},(0,e.jsx)("option",{value:""},"\u2014"),g.map((t=>(0,e.jsx)("option",{key:t.name,value:t.name},t.alias))))),(0,e.jsx)(a.Button,{size:"sm",type:"tertiary",style:{marginTop:8,background:"#c33",color:"#fff"},onClick:()=>this.removeBar(o)},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0431\u0430\u0440")))),(0,e.jsx)(a.Button,{onClick:this.addBar,style:{width:"100%",marginTop:10},size:"sm"},"+ \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0431\u0430\u0440")),(0,e.jsx)("div",{style:o},(0,e.jsx)("div",{style:r},(0,e.jsx)("span",{style:l},"\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a (RU)"),(0,e.jsx)(a.TextInput,{value:x.title_ru||"",onChange:e=>this.updateProp("title_ru",e.target.value)}),(0,e.jsx)("span",{style:l},"\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a (UZ)"),(0,e.jsx)(a.TextInput,{value:x.title_uz||"",onChange:e=>this.updateProp("title_uz",e.target.value)}),(0,e.jsx)("span",{style:l},"\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a (UZCRYL)"),(0,e.jsx)(a.TextInput,{value:x.title_uzcryl||"",onChange:e=>this.updateProp("title_uzcryl",e.target.value)})),(0,e.jsx)("div",{style:r},(0,e.jsx)("span",{style:l},"\u0410\u0442\u0440\u0438\u0431\u0443\u0442 \u0434\u043b\u044f \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0430"),(0,e.jsx)(a.Select,{value:x.titleAttribute||"",onChange:e=>this.updateProp("titleAttribute",e.target.value)},(0,e.jsx)("option",{value:""},"\u2014"),g.map((t=>(0,e.jsx)("option",{key:t.name,value:t.name},t.alias))))),(0,e.jsx)("div",{style:r},(0,e.jsx)("span",{style:l},"\u0420\u0430\u0437\u043c\u0435\u0440 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0430"),(0,e.jsx)(a.NumericInput,{value:x.titleFontSize||17,min:10,max:36,onChange:e=>this.updateProp("titleFontSize",e)}))),(0,e.jsx)("div",{style:o},(0,e.jsx)("div",{style:Object.assign(Object.assign({},l),{fontSize:16,marginBottom:8})},"\u0426\u0432\u0435\u0442\u0430 \u0442\u0435\u043a\u0441\u0442\u0430"),(0,e.jsx)("div",{style:r},(0,e.jsx)("span",{style:l},"\u0426\u0432\u0435\u0442 \u043f\u0440\u043e\u0446\u0435\u043d\u0442\u043e\u0432 (\u0441\u0432\u0435\u0442\u043b\u0430\u044f \u0442\u0435\u043c\u0430)"),(0,e.jsx)(s.ColorPicker,{color:x.percentTextColor||"#333",onChange:e=>this.updateProp("percentTextColor",e)}),(0,e.jsx)("span",{style:l},"\u0426\u0432\u0435\u0442 \u043f\u0440\u043e\u0446\u0435\u043d\u0442\u043e\u0432 (\u0442\u0451\u043c\u043d\u0430\u044f \u0442\u0435\u043c\u0430)"),(0,e.jsx)(s.ColorPicker,{color:x.percentTextColorDark||"#fff",onChange:e=>this.updateProp("percentTextColorDark",e)})),(0,e.jsx)("div",{style:r},(0,e.jsx)("span",{style:l},"\u0426\u0432\u0435\u0442 \u043f\u043e\u0434\u043f\u0438\u0441\u0435\u0439 \u0431\u0430\u0440\u043e\u0432 (\u0441\u0432\u0435\u0442\u043b\u0430\u044f \u0442\u0435\u043c\u0430)"),(0,e.jsx)(s.ColorPicker,{color:x.barLabelTextColor||"#333",onChange:e=>this.updateProp("barLabelTextColor",e)}),(0,e.jsx)("span",{style:l},"\u0426\u0432\u0435\u0442 \u043f\u043e\u0434\u043f\u0438\u0441\u0435\u0439 \u0431\u0430\u0440\u043e\u0432 (\u0442\u0451\u043c\u043d\u0430\u044f \u0442\u0435\u043c\u0430)"),(0,e.jsx)(s.ColorPicker,{color:x.barLabelTextColorDark||"#fff",onChange:e=>this.updateProp("barLabelTextColorDark",e)}))),(0,e.jsx)("div",{style:o},(0,e.jsx)("div",{style:Object.assign(Object.assign({},l),{fontSize:16,marginBottom:8})},"\u0426\u0432\u0435\u0442 \u0444\u043e\u043d\u0430"),(0,e.jsx)("div",{style:r},(0,e.jsx)("span",{style:l},"\u0424\u043e\u043d (\u0441\u0432\u0435\u0442\u043b\u0430\u044f \u0442\u0435\u043c\u0430)"),(0,e.jsx)(s.ColorPicker,{color:x.bgColor||"#fff",onChange:e=>this.updateProp("bgColor",e)}),(0,e.jsx)("span",{style:l},"\u0424\u043e\u043d (\u0442\u0451\u043c\u043d\u0430\u044f \u0442\u0435\u043c\u0430)"),(0,e.jsx)(s.ColorPicker,{color:x.bgColorDark||"#232324",onChange:e=>this.updateProp("bgColorDark",e)}))),(0,e.jsx)("div",{style:o},(0,e.jsx)("div",{style:Object.assign(Object.assign({},l),{fontSize:16,marginBottom:8})},"\u0421\u043a\u0440\u0443\u0433\u043b\u0435\u043d\u0438\u0435 \u0443\u0433\u043b\u043e\u0432"),(0,e.jsx)("div",{style:r},(0,e.jsx)("span",{style:l},"\u041a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 (px)"),(0,e.jsx)(a.NumericInput,{value:null!==(n=x.borderRadius)&&void 0!==n?n:16,min:0,max:64,onChange:e=>this.updateProp("borderRadius",e)}),(0,e.jsx)("span",{style:l},"\u0411\u0430\u0440\u044b (px)"),(0,e.jsx)(a.NumericInput,{value:null!==(u=x.barBorderRadius)&&void 0!==u?u:18,min:0,max:64,onChange:e=>this.updateProp("barBorderRadius",e)}),(0,e.jsx)("span",{style:l},"\u0411\u0430\u0440\u044b \u0431\u043e\u0440\u0434\u0435\u0440 (px)"),(0,e.jsx)(a.NumericInput,{value:null!==(p=x.barBorderWidth)&&void 0!==p?p:"0px",min:0,max:64,onChange:e=>this.updateProp("barBorderWidth",e)}),(0,e.jsx)("span",{style:l},"\u0411\u0430\u0440\u044b \u0431\u043e\u0440\u0434\u0435\u0440 \u0446\u0432\u0435\u0442"),(0,e.jsx)(s.ColorPicker,{color:null!==(d=x.barBorderColor)&&void 0!==d?d:"#fff",onChange:e=>this.updateProp("barBorderColor",e)}))),(0,e.jsx)("div",{style:o},(0,e.jsx)("div",{style:Object.assign(Object.assign({},l),{fontSize:16,marginBottom:8})},"\u0410\u043d\u0438\u043c\u0430\u0446\u0438\u044f \u0438 \u043e\u0442\u0441\u0442\u0443\u043f\u044b"),(0,e.jsx)("div",{style:r},(0,e.jsx)("span",{style:l},"\u041e\u0442\u0441\u0442\u0443\u043f \u043c\u0435\u0436\u0434\u0443 \u0431\u0430\u0440\u0430\u043c\u0438 (px)"),(0,e.jsx)(a.NumericInput,{value:null!==(c=x.barMargin)&&void 0!==c?c:10,min:0,max:40,onChange:e=>this.updateProp("barMargin",e)}),(0,e.jsx)("span",{style:l},"\u0410\u043d\u0438\u043c\u0430\u0446\u0438\u044f \u043f\u0440\u0438 \u043d\u0430\u0432\u0435\u0434\u0435\u043d\u0438\u0438"),(0,e.jsx)(a.Select,{value:!1===x.enableBarAnimation?"off":"on",onChange:e=>this.updateProp("enableBarAnimation","on"===e.target.value)},(0,e.jsx)("option",{value:"on"},"\u0412\u043a\u043b\u044e\u0447\u0435\u043d\u0430"),(0,e.jsx)("option",{value:"off"},"\u041e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u0430")))))}}function p(e){i.p=e}})(),n})())}}}));