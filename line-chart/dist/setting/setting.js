/*! For license information please see setting.js.LICENSE.txt */
System.register(["jimu-core","jimu-ui","jimu-ui/advanced/data-source-selector","jimu-ui/basic/color-picker","jimu-core/react"],(function(e,t){var s={},o={},a={},i={},l={};return{setters:[function(e){s.DataSourceManager=e.DataSourceManager,s.DataSourceTypes=e.DataSourceTypes,s.Immutable=e.Immutable,s.React=e.React,s.jsx=e.jsx},function(e){o.Button=e.Button,o.NumericInput=e.NumericInput,o.Select=e.Select,o.Switch=e.Switch,o.TextInput=e.TextInput},function(e){a.DataSourceSelector=e.DataSourceSelector},function(e){i.ColorPicker=e.ColorPicker},function(e){l.createElement=e.createElement,l.forwardRef=e.forwardRef}],execute:function(){e((()=>{var e={8891:e=>{"use strict";e.exports=s},1315:e=>{"use strict";e.exports=l},726:e=>{"use strict";e.exports=o},338:e=>{"use strict";e.exports=a},1362:e=>{"use strict";e.exports=i}},t={};function r(s){var o=t[s];if(void 0!==o)return o.exports;var a=t[s]={exports:{}};return e[s](a,a.exports,r),a.exports}r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="";var n={};return r.p=window.jimuConfig.baseUrl,(()=>{"use strict";r.r(n),r.d(n,{__set_webpack_public_path__:()=>m,default:()=>v});var e=r(8891),t=r(726),s=r(338),o=r(1362),a=r(1315);const i=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,((e,t,s)=>s?s.toUpperCase():t.toLowerCase())))(e);return t.charAt(0).toUpperCase()+t.slice(1)},l=(...e)=>e.filter(((e,t,s)=>Boolean(e)&&""!==e.trim()&&s.indexOf(e)===t)).join(" ").trim(),p=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const u=(0,a.forwardRef)((({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:i="",children:r,iconNode:n,...u},c)=>(0,a.createElement)("svg",{ref:c,...d,width:t,height:t,stroke:e,strokeWidth:o?24*Number(s)/Number(t):s,className:l("lucide",i),...!r&&!p(u)&&{"aria-hidden":"true"},...u},[...n.map((([e,t])=>(0,a.createElement)(e,t))),...Array.isArray(r)?r:[r]]))),c=(e,t)=>{const s=(0,a.forwardRef)((({className:s,...o},r)=>{return(0,a.createElement)(u,{ref:r,iconNode:t,className:l(`lucide-${n=i(e),n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,s),...o});var n}));return s.displayName=i(e),s},h=c("trash",[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),x=c("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),j={display:"flex",flexDirection:"column",gap:4,marginBottom:14},g={fontWeight:500,fontSize:13,marginBottom:2,color:"#fff"},y={background:"#333",borderRadius:10,padding:16,marginBottom:22,boxShadow:"0 1px 3px rgba(0,0,0,0.04)"};class v extends e.React.PureComponent{constructor(t){super(t),this.supportedTypes=(0,e.Immutable)([e.DataSourceTypes.FeatureLayer]),this.updateAvailableFields=()=>{var t;const s=null===(t=this.props.useDataSources)||void 0===t?void 0:t[0];if(!s)return void this.setState({availableFields:[]});const o=e.DataSourceManager.getInstance().getDataSource(s.dataSourceId),a=null==o?void 0:o.getSchema(),i=(null==a?void 0:a.fields)?Object.keys(a.fields):[];this.setState({availableFields:i})},this.updateProp=(e,t)=>{this.props.onSettingChange({id:this.props.id,config:Object.assign(Object.assign({},this.props.config),{[e]:t})})},this.updateLine=(e,t,s)=>{const o=[...this.props.config.lines||[]];o[e]=Object.assign(Object.assign({},o[e]),{[t]:s}),this.updateProp("lines",o)},this.addLine=()=>{const e=this.state.availableFields[0];if(e){const t={field:e,label:e,color:"#000000",pointColor:"#000000",strokeWidth:2,pointRadius:4,show:!0,lineStyle:"monotone"},s=[...this.props.config.lines||[],t];this.updateProp("lines",s)}else alert("Нет доступных полей в выбранном источнике данных.")},this.removeLine=e=>{const t=[...this.props.config.lines||[]];t.splice(e,1),this.updateProp("lines",t)},this.onDataSourceChange=e=>{this.props.onSettingChange({id:this.props.id,useDataSources:e}),setTimeout(this.updateAvailableFields,200)},this.state={availableFields:[]}}componentDidMount(){this.updateAvailableFields()}componentDidUpdate(e){e.useDataSources!==this.props.useDataSources&&this.updateAvailableFields()}render(){var a,i,l,r,n;const{config:p,useDataSources:d}=this.props,{availableFields:u}=this.state,c=Array.isArray(p.availableYears)?p.availableYears:[];return(0,e.jsx)("div",{className:"p-3",style:{fontSize:14,color:"#222",background:"#666"}},(0,e.jsx)("div",{style:y},(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Источник данных"),(0,e.jsx)(s.DataSourceSelector,{mustUseDataSource:!0,types:this.supportedTypes,useDataSources:d,onChange:this.onDataSourceChange,widgetId:this.props.id}))),(0,e.jsx)("div",{style:y},(0,e.jsx)("span",{style:Object.assign(Object.assign({},g),{marginBottom:10,fontSize:15})},"Линии"),null===(a=p.lines)||void 0===a?void 0:a.map(((s,a)=>{var i,l;return(0,e.jsx)("div",{key:a,style:Object.assign(Object.assign({},j),{background:"#333",marginBottom:16})},(0,e.jsx)("span",{style:Object.assign(Object.assign({},g),{fontSize:14})},"Линия ",a+1),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Поле"),(0,e.jsx)(t.Select,{size:"sm",value:s.field,onChange:e=>this.updateLine(a,"field",e.target.value)},u.map((t=>(0,e.jsx)("option",{key:t,value:t},t))))),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Показывать линию"),(0,e.jsx)(t.Switch,{checked:s.show,onChange:e=>this.updateLine(a,"show",e.target.checked)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Разрешить overlap (для сравнения)"),(0,e.jsx)(t.Switch,{checked:!!s.overlap,onChange:e=>this.updateLine(a,"overlap",e.target.checked)})),(0,e.jsx)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12}},(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Цвет линии"),(0,e.jsx)(o.ColorPicker,{color:s.color,onChange:e=>this.updateLine(a,"color",e)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Цвет точки"),(0,e.jsx)(o.ColorPicker,{color:s.pointColor,onChange:e=>this.updateLine(a,"pointColor",e)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Радиус точки"),(0,e.jsx)(t.NumericInput,{size:"sm",value:null!==(i=s.pointRadius)&&void 0!==i?i:4,onChange:e=>this.updateLine(a,"pointRadius",e)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Толщина"),(0,e.jsx)(t.NumericInput,{size:"sm",value:null!==(l=s.strokeWidth)&&void 0!==l?l:2,onChange:e=>this.updateLine(a,"strokeWidth",e)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Стиль линии"),(0,e.jsx)(t.Select,{size:"sm",value:s.lineStyle||"monotone",onChange:e=>this.updateLine(a,"lineStyle",e.target.value)},(0,e.jsx)("option",{value:"monotone"},"Monotone"),(0,e.jsx)("option",{value:"linear"},"Linear"),(0,e.jsx)("option",{value:"step"},"Step"),(0,e.jsx)("option",{value:"basis"},"Basis")))),(0,e.jsx)(t.Button,{size:"sm",type:"tertiary",style:{marginTop:8,width:"100%",background:"#ee0303",color:"#fff"},onClick:()=>this.removeLine(a)},(0,e.jsx)(h,{style:{marginRight:5,width:"15px"}}),"Удалить линию"))})),(0,e.jsx)(t.Button,{onClick:this.addLine,style:{width:"100%"},size:"sm"},(0,e.jsx)(x,{style:{marginRight:5,width:"15px"}}),"Добавить линию")),(0,e.jsx)("div",{style:y},(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Годы для сравнения (максимум 10)"),c.map(((s,o)=>(0,e.jsx)("div",{key:o,style:{display:"flex",alignItems:"center",marginBottom:6}},(0,e.jsx)(t.NumericInput,{style:{width:90,marginRight:12},value:s,min:1900,max:2200,step:1,onChange:e=>{const t=[...c];t[o]=Number(e),this.updateProp("availableYears",t.filter(Boolean))}}),c.length>1&&(0,e.jsx)(t.Button,{size:"sm",type:"tertiary",style:{padding:2,color:"#fff",background:"#c33",borderRadius:6},onClick:()=>{const e=[...c];e.splice(o,1),this.updateProp("availableYears",e)}},(0,e.jsx)("span",{style:{fontSize:20,lineHeight:0}},"×"))))),(0,e.jsx)(t.Button,{size:"sm",style:{marginTop:6,width:120,background:"#1a4",color:"#fff",borderRadius:8},disabled:c.length>=10,onClick:()=>{if(c.length<10){const e=c.length>0?Math.max(...c)+1:(new Date).getFullYear();this.updateProp("availableYears",[...c,e])}}},"+ Добавить год"),(0,e.jsx)("span",{style:{fontSize:12,color:"#eee",marginTop:4}},"В этих полях можно задать до 5 годов. Они появятся в дропдауне виджета."))),(0,e.jsx)("div",{style:y},(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Поле X-Axis"),(0,e.jsx)(t.Select,{size:"sm",value:p.xAxisField||u[0]||"",onChange:e=>this.updateProp("xAxisField",e.target.value)},u.map((t=>(0,e.jsx)("option",{key:t,value:t},t)))))),(0,e.jsx)("div",{style:y},(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Заголовок (UZ)"),(0,e.jsx)(t.TextInput,{value:p.chartTitle||"",onChange:e=>this.updateProp("chartTitle",e.target.value)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Заголовок (RU)"),(0,e.jsx)(t.TextInput,{value:p.chartTitleRu||"",onChange:e=>this.updateProp("chartTitleRu",e.target.value)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Заголовок (UZCRYL)"),(0,e.jsx)(t.TextInput,{value:p.chartTitleUzCryl||"",onChange:e=>this.updateProp("chartTitleUzCryl",e.target.value)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Шрифт"),(0,e.jsx)(t.TextInput,{value:p.chartTitleFontFamily||"",placeholder:"Times",onChange:e=>this.updateProp("chartTitleFontFamily",e.target.value)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Размер шрифта"),(0,e.jsx)(t.NumericInput,{value:null!==(i=p.chartTitleFontSize)&&void 0!==i?i:18,onChange:e=>this.updateProp("chartTitleFontSize",e)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Отступ сверху"),(0,e.jsx)(t.NumericInput,{value:null!==(l=p.chartTitlePaddingTop)&&void 0!==l?l:0,onChange:e=>this.updateProp("chartTitlePaddingTop",e)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Выравнивание"),(0,e.jsx)(t.Select,{value:p.chartTitleAlign||"left",onChange:e=>this.updateProp("chartTitleAlign",e.target.value)},(0,e.jsx)("option",{value:"left"},"Слева"),(0,e.jsx)("option",{value:"center"},"По центру"),(0,e.jsx)("option",{value:"right"},"Справа")))),(0,e.jsx)("div",{style:y},(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Цвет текста"),(0,e.jsx)(o.ColorPicker,{color:p.textColor,onChange:e=>this.updateProp("textColor",e)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Фон"),(0,e.jsx)(o.ColorPicker,{color:p.bgColor,onChange:e=>this.updateProp("bgColor",e)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Сетка"),(0,e.jsx)(t.Switch,{checked:p.showGrid,onChange:e=>this.updateProp("showGrid",e.target.checked)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Tooltip"),(0,e.jsx)(t.Switch,{checked:p.showTooltip,onChange:e=>this.updateProp("showTooltip",e.target.checked)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Легенда"),(0,e.jsx)(t.Switch,{checked:p.showLegend,onChange:e=>this.updateProp("showLegend",e.target.checked)}))),(0,e.jsx)("div",{style:y},(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Фон tooltip"),(0,e.jsx)(o.ColorPicker,{color:p.tooltipBg,onChange:e=>this.updateProp("tooltipBg",e)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Цвет текста tooltip"),(0,e.jsx)(o.ColorPicker,{color:p.tooltipTextColor,onChange:e=>this.updateProp("tooltipTextColor",e)}))),(0,e.jsx)("div",{style:y},(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Зум"),(0,e.jsx)(t.Switch,{checked:p.zoomEnabled,onChange:e=>this.updateProp("zoomEnabled",e.target.checked)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Тень под линией"),(0,e.jsx)(t.Switch,{checked:p.showShadow,onChange:e=>this.updateProp("showShadow",e.target.checked)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Полный экран"),(0,e.jsx)(t.Switch,{checked:p.fullscreenEnabled,onChange:e=>this.updateProp("fullscreenEnabled",e.target.checked)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Позиция кнопки полного экрана"),(0,e.jsx)(t.Select,{value:p.fullscreenBtnPosition||"top-right",onChange:e=>this.updateProp("fullscreenBtnPosition",e.target.value)},(0,e.jsx)("option",{value:"top-left"},"Слева сверху"),(0,e.jsx)("option",{value:"top-right"},"Справа сверху"),(0,e.jsx)("option",{value:"bottom-left"},"Слева снизу"),(0,e.jsx)("option",{value:"bottom-right"},"Справа снизу"))),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Размер кнопки"),(0,e.jsx)(t.NumericInput,{value:null!==(r=p.fullscreenBtnSize)&&void 0!==r?r:36,onChange:e=>this.updateProp("fullscreenBtnSize",e)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Фон кнопки"),(0,e.jsx)(o.ColorPicker,{color:p.fullscreenBtnBgColor,onChange:e=>this.updateProp("fullscreenBtnBgColor",e)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Цвет иконки"),(0,e.jsx)(o.ColorPicker,{color:p.fullscreenBtnTextColor,onChange:e=>this.updateProp("fullscreenBtnTextColor",e)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Размер иконки"),(0,e.jsx)(t.NumericInput,{value:null!==(n=p.fullscreenBtnIconSize)&&void 0!==n?n:16,onChange:e=>this.updateProp("fullscreenBtnIconSize",e)}))),(0,e.jsx)("div",{style:y},(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Радиус (слева сверху)"),(0,e.jsx)(t.TextInput,{value:p.borderTopLeftRadius||"",onChange:e=>this.updateProp("borderTopLeftRadius",e.target.value)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Радиус (справа сверху)"),(0,e.jsx)(t.TextInput,{value:p.borderTopRightRadius||"",onChange:e=>this.updateProp("borderTopRightRadius",e.target.value)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Радиус (слева снизу)"),(0,e.jsx)(t.TextInput,{value:p.borderBottomLeftRadius||"",onChange:e=>this.updateProp("borderBottomLeftRadius",e.target.value)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Радиус (справа снизу)"),(0,e.jsx)(t.TextInput,{value:p.borderBottomRightRadius||"",onChange:e=>this.updateProp("borderBottomRightRadius",e.target.value)}))),(0,e.jsx)("div",{style:y},(0,e.jsx)("span",{style:Object.assign(Object.assign({},g),{marginBottom:10,fontSize:15})},"Темная тема"),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Включить автоматическое переключение"),(0,e.jsx)(t.Switch,{checked:p.enableDarkTheme,onChange:e=>this.updateProp("enableDarkTheme",e.target.checked)})),p.enableDarkTheme&&(0,e.jsx)("div",null,(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Фон (темная тема)"),(0,e.jsx)(o.ColorPicker,{color:p.darkThemeBgColor,onChange:e=>this.updateProp("darkThemeBgColor",e)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Цвет текста (темная тема)"),(0,e.jsx)(o.ColorPicker,{color:p.darkThemeTextColor,onChange:e=>this.updateProp("darkThemeTextColor",e)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Цвет границы (темная тема)"),(0,e.jsx)(o.ColorPicker,{color:p.darkThemeBorderColor,onChange:e=>this.updateProp("darkThemeBorderColor",e)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Цвет сетки (темная тема)"),(0,e.jsx)(o.ColorPicker,{color:p.darkThemeGridColor,onChange:e=>this.updateProp("darkThemeGridColor",e)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Фон тултипа (темная тема)"),(0,e.jsx)(o.ColorPicker,{color:p.darkThemeTooltipBg,onChange:e=>this.updateProp("darkThemeTooltipBg",e)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Текст тултипа (темная тема)"),(0,e.jsx)(o.ColorPicker,{color:p.darkThemeTooltipTextColor,onChange:e=>this.updateProp("darkThemeTooltipTextColor",e)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Текст легенды (темная тема)"),(0,e.jsx)(o.ColorPicker,{color:p.darkThemeLegendTextColor,onChange:e=>this.updateProp("darkThemeLegendTextColor",e)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Фон кнопки"),(0,e.jsx)(o.ColorPicker,{color:p.darkThemeFullscreenBtnBgColor,onChange:e=>this.updateProp("darkThemeFullscreenBtnBgColor",e)})),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Цвет иконки"),(0,e.jsx)(o.ColorPicker,{color:p.darkThemeFullscreenBtnTextColor,onChange:e=>this.updateProp("darkThemeFullscreenBtnTextColor",e)})))),(0,e.jsx)("div",{style:y},(0,e.jsx)("span",{style:Object.assign(Object.assign({},g),{marginBottom:10,fontSize:15})},"Экспорт по датам"),(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Включить календарь для выбора дат"),(0,e.jsx)(t.Switch,{checked:p.dateRangeExportEnabled,onChange:e=>this.updateProp("dateRangeExportEnabled",e.target.checked)})),p.dateRangeExportEnabled&&(0,e.jsx)("div",{style:j},(0,e.jsx)("span",{style:g},"Позиция календаря"),(0,e.jsx)(t.Select,{value:p.dateRangeExportPosition||"left",onChange:e=>this.updateProp("dateRangeExportPosition",e.target.value)},(0,e.jsx)("option",{value:"left"},"Слева от выбора годов"),(0,e.jsx)("option",{value:"right"},"Справа от выбора годов")))))}}function m(e){r.p=e}})(),n})())}}}));