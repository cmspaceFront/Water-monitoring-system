System.register(["jimu-core","jimu-core/react","jimu-ui"],(function(o,e){var t={},r={},i={};return{setters:[function(o){t.DataSourceComponent=o.DataSourceComponent,t.jsx=o.jsx},function(o){r.useEffect=o.useEffect,r.useState=o.useState},function(o){i.Card=o.Card,i.CardBody=o.CardBody}],execute:function(){o((()=>{var o={9521:(o,e,t)=>{"use strict";t.d(e,{Z:()=>s});var r=t(8081),i=t.n(r),n=t(3645),a=t.n(n)()(i());a.push([o.id,".language-widget{font-family:sans-serif;position:relative}.lang-btn{border:none;cursor:pointer;text-align:center;display:flex;align-items:center;height:auto;white-space:nowrap;overflow:visible}",""]);const s=a},3645:o=>{"use strict";o.exports=function(o){var e=[];return e.toString=function(){return this.map((function(e){var t="",r=void 0!==e[5];return e[4]&&(t+="@supports (".concat(e[4],") {")),e[2]&&(t+="@media ".concat(e[2]," {")),r&&(t+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),t+=o(e),r&&(t+="}"),e[2]&&(t+="}"),e[4]&&(t+="}"),t})).join("")},e.i=function(o,t,r,i,n){"string"==typeof o&&(o=[[null,o,void 0]]);var a={};if(r)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(a[l]=!0)}for(var u=0;u<o.length;u++){var c=[].concat(o[u]);r&&a[c[0]]||(void 0!==n&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=n),t&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=t):c[2]=t),i&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=i):c[4]="".concat(i)),e.push(c))}},e}},8081:o=>{"use strict";o.exports=function(o){return o[1]}},3379:o=>{"use strict";var e=[];function t(o){for(var t=-1,r=0;r<e.length;r++)if(e[r].identifier===o){t=r;break}return t}function r(o,r){for(var n={},a=[],s=0;s<o.length;s++){var l=o[s],u=r.base?l[0]+r.base:l[0],c=n[u]||0,d="".concat(u," ").concat(c);n[u]=c+1;var v=t(d),m={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==v)e[v].references++,e[v].updater(m);else{var g=i(m,r);r.byIndex=s,e.splice(s,0,{identifier:d,updater:g,references:1})}a.push(d)}return a}function i(o,e){var t=e.domAPI(e);return t.update(o),function(e){if(e){if(e.css===o.css&&e.media===o.media&&e.sourceMap===o.sourceMap&&e.supports===o.supports&&e.layer===o.layer)return;t.update(o=e)}else t.remove()}}o.exports=function(o,i){var n=r(o=o||[],i=i||{});return function(o){o=o||[];for(var a=0;a<n.length;a++){var s=t(n[a]);e[s].references--}for(var l=r(o,i),u=0;u<n.length;u++){var c=t(n[u]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}n=l}}},569:o=>{"use strict";var e={};o.exports=function(o,t){var r=function(o){if(void 0===e[o]){var t=document.querySelector(o);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(o){t=null}e[o]=t}return e[o]}(o);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}},9216:o=>{"use strict";o.exports=function(o){var e=document.createElement("style");return o.setAttributes(e,o.attributes),o.insert(e,o.options),e}},3565:(o,e,t)=>{"use strict";o.exports=function(o){var e=t.nc;e&&o.setAttribute("nonce",e)}},7795:o=>{"use strict";o.exports=function(o){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=o.insertStyleElement(o);return{update:function(t){!function(o,e,t){var r="";t.supports&&(r+="@supports (".concat(t.supports,") {")),t.media&&(r+="@media ".concat(t.media," {"));var i=void 0!==t.layer;i&&(r+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),r+=t.css,i&&(r+="}"),t.media&&(r+="}"),t.supports&&(r+="}");var n=t.sourceMap;n&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),e.styleTagTransform(r,o,e.options)}(e,o,t)},remove:function(){!function(o){if(null===o.parentNode)return!1;o.parentNode.removeChild(o)}(e)}}}},4589:o=>{"use strict";o.exports=function(o,e){if(e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}},8891:o=>{"use strict";o.exports=t},1315:o=>{"use strict";o.exports=r},726:o=>{"use strict";o.exports=i}},e={};function n(t){var r=e[t];if(void 0!==r)return r.exports;var i=e[t]={id:t,exports:{}};return o[t](i,i.exports,n),i.exports}n.n=o=>{var e=o&&o.__esModule?()=>o.default:()=>o;return n.d(e,{a:e}),e},n.d=(o,e)=>{for(var t in e)n.o(e,t)&&!n.o(o,t)&&Object.defineProperty(o,t,{enumerable:!0,get:e[t]})},n.o=(o,e)=>Object.prototype.hasOwnProperty.call(o,e),n.r=o=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},n.p="",n.nc=void 0;var a={};return n.p=window.jimuConfig.baseUrl,(()=>{"use strict";n.r(a),n.d(a,{__set_webpack_public_path__:()=>_,default:()=>L,setSelectedDam:()=>E});var o=n(8891),e=n(1315),t=n(726),r=n(3379),i=n.n(r),s=n(7795),l=n.n(s),u=n(569),c=n.n(u),d=n(3565),v=n.n(d),m=n(9216),g=n.n(m),f=n(4589),p=n.n(f),b=n(9521),h={};h.styleTagTransform=p(),h.setAttributes=v(),h.insert=c().bind(null,"head"),h.domAPI=l(),h.insertStyleElement=g(),i()(b.Z,h),b.Z&&b.Z.locals&&b.Z.locals;const y={uz:{water_level:"Suv darajasi",water_volume:"Suv hajmi"},ru:{water_level:"Уровень воды",water_volume:"Объем воды"},uzcryl:{water_level:"Сув даражаси",water_volume:"Сув ҳажми"}},x=["Arnasoy suv ombori","Asaka adir suv ombori","Chimqo'rg'on suv ombori","Chortoq suv ombori","Chorvoq suv ombori","Degrez suv ombori","Dehqonobod suv ombori","Ertikon suv ombori","Eski yer suv ombori","Girvonsoy suv ombori","Hisorak suv ombori","Janubiy-Surhon suv ombori","Jiydalisoy suv ombori","Jizzax suv ombori","Kamashi suv ombori","Kamongaron suv ombori","Karkidon suv ombori","Kattaqo'rg'on suv ombori","Kengko'l suv ombori","ko'ksaroy suv ombori","Koksereksoy suv ombori","Langar suv ombori","Markaziy Fargona suv ombori","Nugayli suv ombori","Ohangaron suv ombori","Omondora suv ombori","Oqbilol suv ombori","Oqbuloq suv omvori","Oqchobsoy suv ombori","Oqdaryo suv ombori","Oqtepa suv ombori","Pachkamar suv ombori","Qalqama sel ombori","Qizilsuv suv ombori","Qorabog' suv ombori","Qoramurut sel ombori","Qorasuv suv ombori","Qorasuv suv ombori (Namangan)","Qorasuvnamangan suv ombori","Qorasuvsamarqand suv ombori","Qoratepa suv ombori","Qorovultepa suv ombori","Qurgontepa suv ombori","Quyimozor suv ombori","Rezaksoy suv ombori","Sentobsoy suv ombori","Sho'rko'l suv ombori","sho'robsoy sov ombori","Sobirsoy suv ombori","Talimarjon suv ombori","To'dako'l suv ombori","To'palang suv ombori","Toshkent suv ombori","Tusunsoy suv ombori","Uchqizil suv ombori","Varzik suv ombori","Xo'jamushkent suv ombori","Yangi Qo'rg'on suv ombori","Zomin suv ombori","Mo'minobod sel ombori"];function S(o){return o.toLowerCase().replace(/['''`]/g,"").replace(/\s+/g,"").replace(/[\(\)]/g,"")}const w={};x.forEach((o=>{const e=S(o);let t=e.replace(/suvombori.*$/g,"").replace(/selombori.*$/g,"").replace(/sovombori.*$/g,"");t.endsWith("ko")&&(t+="l"),w[t]=o,w[e]=o}));const C={tosinsoy:"tusunsoy",kattakorgon:"kattaqorgon",oktepa:"oqtepa",jizzakh:"jizzax",qorgontepa:"qurgontepa",quyumozor:"quyimozor",shurkul:"shorkol",yangikurgan:"yangiqorgon",qamashi:"kamashi",girvansoy:"girvonsoy",omondara:"omondora",sentabsoy:"sentobsoy",chimqurgon:"chimqorgon",surxon:"surhon",varziq:"varzik"};function k(o){if(!o)return null;const e=S(o);if(C[e])return k(C[e]);if(w[e])return w[e];const t=Object.keys(w).find((o=>e===o||e.startsWith(o)));if(t)return w[t];return x.find((o=>S(o).includes(e)||e.includes(S(o))))||o}function j(o){const e=k(o);return e?`suv_ombori = '${t=e,String(t).replace(/'/g,"''")}'`:"1=1";var t}const E=o=>{localStorage.setItem("selected_dam",o),window.dispatchEvent(new CustomEvent("dam_name_changed")),window.dispatchEvent(new CustomEvent("selected_dam_changed")),window.dispatchEvent(new CustomEvent("dam_selected"))},D=r=>{var i,n,a,s,l,u,c,d,v,m,g,f,p,b,h,x,S,w,C,k,E,D,L,_,z,q,T,O,{dambName:I,locale:F}=r,N=function(o,e){var t={};for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&e.indexOf(r)<0&&(t[r]=o[r]);if(null!=o&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(o);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(o,r[i])&&(t[r[i]]=o[r[i]])}return t}(r,["dambName","locale"]);const[$,M]=(0,e.useState)([]),[R,Q]=(0,e.useState)(),[U,A]=(0,e.useState)({}),[B,P]=(0,e.useState)(""),[W,H]=(0,e.useState)(!1),[K,V]=(0,e.useState)(null),Z=N.config.statsConfig||[],[G,J]=(0,e.useState)(localStorage.getItem("customTheme")||"light"),X=y[F]||{};(0,e.useEffect)((()=>{if(V(null),H(!0),!R||!I)return A({}),P(""),void H(!1);if(0===Z.length)return A({}),P(""),H(!1),void V(null);const o=j(I),e=Z.map((o=>o.field)).concat(["suv_ombori","sana"]);R.query({where:o,outFields:e,pageSize:1e3,orderByFields:["sana DESC"],returnGeometry:!1}).then((o=>{const e=o.records||[];if(M(e),e.length>0){const o=e[0],t={},r=o.getFieldValue("sana");if(r){let o="";if(r instanceof Date)o=r.toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric"});else if("string"==typeof r){const e=new Date(r);o=isNaN(e.getTime())?String(r):e.toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric"})}else o=String(r);P(o)}Z.forEach((({field:e})=>{const r=o.getFieldValue(e);t[e]=null==r?"":"number"==typeof r?r:String(r)})),A(t),V(null)}else A({}),P(""),V(null);H(!1)})).catch((o=>{A({}),P(""),V(null),H(!1)}))}),[R,I,Z,G]);const Y="dark"===G,oo={display:"grid",gridTemplateColumns:(()=>{var o,e;const t=(null===(o=N.config)||void 0===o?void 0:o.gridOrientation)||"horizontal",r=Z.length;return"vertical"===t?"1fr":(null===(e=N.config)||void 0===e?void 0:e.gridTemplateColumns)||`repeat(${Math.min(r,3)}, 1fr)`})(),gap:(null===(i=N.config)||void 0===i?void 0:i.gridGap)||"12px",padding:"16px",width:(null===(n=N.config)||void 0===n?void 0:n.gridWidth)||"100%",height:(null===(a=N.config)||void 0===a?void 0:a.gridHeight)||"auto",minHeight:"auto"!==(null===(s=N.config)||void 0===s?void 0:s.gridHeight)?null===(l=N.config)||void 0===l?void 0:l.gridHeight:void 0,backgroundColor:Y?(null===(u=N.config)||void 0===u?void 0:u.bgColorDark)||"#23272f":(null===(c=N.config)||void 0===c?void 0:c.bgColor)||"var(--light-100)",boxSizing:"border-box"},eo={backgroundColor:Y?(null===(d=N.config)||void 0===d?void 0:d.cardBgColorDark)||"#23272f":(null===(v=N.config)||void 0===v?void 0:v.cardBgColor)||"#ffffff",borderRadius:(null===(m=N.config)||void 0===m?void 0:m.cardBorderRadius)||"10px",padding:(null===(g=N.config)||void 0===g?void 0:g.cardPadding)||"16px",border:`${(null===(f=N.config)||void 0===f?void 0:f.cardBorderWidth)||"1px"} solid ${Y?(null===(p=N.config)||void 0===p?void 0:p.cardBorderColorDark)||"#444":(null===(b=N.config)||void 0===b?void 0:b.cardBorderColor)||"#cccccc"}`,textAlign:"center",display:"flex",flexDirection:(null===(h=N.config)||void 0===h?void 0:h.cardDisplay)||"column",justifyContent:"center",width:(null===(x=N.config)||void 0===x?void 0:x.cardWidth)||"100%",height:(null===(S=N.config)||void 0===S?void 0:S.cardHeight)||"100%",boxSizing:"border-box"},to={fontSize:(null===(w=N.config)||void 0===w?void 0:w.labelFontSize)||"14px",fontWeight:(null===(C=N.config)||void 0===C?void 0:C.labelFontWeight)||"500",color:Y?(null===(k=N.config)||void 0===k?void 0:k.labelColorDark)||"#aaa":(null===(E=N.config)||void 0===E?void 0:E.labelColor)||"#4A4A4A",marginBottom:"row"===(null===(D=N.config)||void 0===D?void 0:D.cardDisplay)?"0":"0px",marginRight:"row"===(null===(L=N.config)||void 0===L?void 0:L.cardDisplay)?"0px":"0"},ro={fontSize:(null===(_=N.config)||void 0===_?void 0:_.valueFontSize)||"20px",fontWeight:(null===(z=N.config)||void 0===z?void 0:z.valueFontWeight)||"700",color:Y?(null===(q=N.config)||void 0===q?void 0:q.textColorDark)||"#fff":(null===(T=N.config)||void 0===T?void 0:T.textColor)||"#000000"};return(0,o.jsx)("div",{className:"jimu-widget reservoir-stats-widget"},(0,o.jsx)(o.DataSourceComponent,{useDataSource:null===(O=N.useDataSources)||void 0===O?void 0:O[0],widgetId:N.id,onDataSourceCreated:o=>{Q(o)}}),W&&(0,o.jsx)("div",{style:{textAlign:"center",padding:"20px",color:Y?"#fff":"#000"}},"Loading data..."),!W&&(0,o.jsx)("div",{className:"grid",style:oo},Z.map(((e,r)=>{var i,n,a,s,l,u,c,d;return(0,o.jsx)(t.Card,{key:r,className:"card",style:eo},(0,o.jsx)(t.CardBody,null,(0,o.jsx)("div",{style:{display:"flex",flexDirection:(null===(i=N.config)||void 0===i?void 0:i.labelValueFlexDirection)||"row",justifyContent:(null===(n=N.config)||void 0===n?void 0:n.labelValueJustifyContent)||"center",alignItems:"center",gap:(null===(a=N.config)||void 0===a?void 0:a.showLabelValueFlexGap)?(null===(s=N.config)||void 0===s?void 0:s.labelValueFlexGap)||"8px":"0px"}},(0,o.jsx)("div",{style:to},(0,o.jsx)("span",null,(null===(l=e.labelText)||void 0===l?void 0:l[F])||X[e.labelKey]||e.labelKey),B&&(0,o.jsx)("span",null,"(",B,")")),!1!==(null===(u=N.config)||void 0===u?void 0:u.showColonSeparator)&&(0,o.jsx)("span",{style:{color:Y?(null===(c=N.config)||void 0===c?void 0:c.textColorDark)||"#fff":(null===(d=N.config)||void 0===d?void 0:d.textColor)||"#000000"}},":"),(0,o.jsx)("div",{style:ro},((o,e,t,r)=>{var i;if(null==o)return"-";const n="string"==typeof o?parseFloat(o):o;if(isNaN(n))return String(o);const a=null===(i=null==t?void 0:t.statsConfig)||void 0===i?void 0:i.find((o=>o.field===e)),s="uz"===r,l=s?"m":"м",u=s?"m³":"м³";if("volume"===(null==a?void 0:a.fieldType)||e.toLowerCase().includes("hajm")||e.toLowerCase().includes("volume")||e.toLowerCase().includes("объем"))return`${n>=1e3?Math.round(n).toLocaleString("ru-RU"):n.toLocaleString("ru-RU",{maximumFractionDigits:1})} ${u}`;if("level"===(null==a?void 0:a.fieldType)||e.toLowerCase().includes("balandlik")||e.toLowerCase().includes("level")||e.toLowerCase().includes("уровень"))return`${n.toLocaleString("ru-RU",{maximumFractionDigits:1})} ${l}`;if("percentage"===(null==a?void 0:a.fieldType))return`${n.toLocaleString("ru-RU",{maximumFractionDigits:1})}%`;if(null==a?void 0:a.unit){const o="м"===a.unit?l:"м³"===a.unit?u:a.unit;return`${n>=1e3?Math.round(n).toLocaleString("ru-RU"):n.toLocaleString("ru-RU",{maximumFractionDigits:1})} ${o}`}return n.toLocaleString("ru-RU",{maximumFractionDigits:1})})(U[e.field],e.field,N.config,F)))))}))))},L=t=>{const[r]=function(){const[o,t]=(0,e.useState)((()=>localStorage.getItem("selected_dam")||""));return(0,e.useEffect)((()=>{const o=o=>{"selected_dam"===o.key&&t(o.newValue||"")};return window.addEventListener("storage",o),()=>window.removeEventListener("storage",o)}),[]),(0,e.useEffect)((()=>{const o=setInterval((()=>{const o=localStorage.getItem("selected_dam")||"";t((e=>e!==o?o:e))}),100);return()=>clearInterval(o)}),[]),[o,o=>{localStorage.setItem("selected_dam",o),t(o)}]}(),[i,n]=(0,e.useState)(localStorage.getItem("custom_locale")||"uz"),[a,s]=(0,e.useState)(localStorage.getItem("customTheme")||"light");return(0,e.useEffect)((()=>{const o=o=>n(o.detail);return window.addEventListener("custom-locale-changed",o),()=>window.removeEventListener("custom-locale-changed",o)}),[]),(0,e.useEffect)((()=>{const o=()=>{const o=localStorage.getItem("customTheme")||"light";s(o)};window.addEventListener("storage",o),window.addEventListener("theme-changed",o);const e=setInterval((()=>{const o=localStorage.getItem("customTheme")||"light";o!==a&&s(o)}),100);return()=>{window.removeEventListener("storage",o),window.removeEventListener("theme-changed",o),clearInterval(e)}}),[a]),r?(0,o.jsx)(D,Object.assign({key:`${r}-${a}`},t,{dambName:r,locale:i})):null};function _(o){n.p=o}})(),a})())}}}));